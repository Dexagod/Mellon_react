{"version":3,"sources":["css/components/profilecard.module.css","../../../src/SystemNotifications/SystemNotificationhandler.ts","../../../src/Notifications/NotificationGenerator.ts","../../../src/InboxIterators/InboxRetrievalAsyncIterator.ts","../../../src/AutoUpdates/UpdateTracker.ts","../../../src/AutoUpdates/PollingTracker.ts","../../../src/AutoUpdates/WebSocketTracker.ts","../../../src/Utils/Logger.ts","../../../src/InboxIterators/InboxRetrievalIterator.ts","../../../src/Utils/SolidError.ts","../../../src/Utils/FileUtils.ts","../../src/NameSpaces.ts","singletons/InboxAgent.js","hooks/useNotifications.js","util/NameSpaces.js","singletons/QueryEngine.js","util/FileUtil.js","Errors/errors.js","util/PermissionManager.js","util/MellonUtils/documents.js","Components/NotificationsViewerComponent.js","util/MellonUtils/profile.js","hooks/useProfile.js","Components/Views/ProfileViewerComponent.js","util/QueryUtil.js","Components/ProfileEditorComponent.js","Components/Help/HelpComponent.js","Components/Login/LoginComponent.js","Components/Views/FeedComponent.js","Components/Documents/ArtefactCard.js","Components/Views/DocumentsViewerComponent.js","Components/ProfileCardComponent.js","Components/ProfileCardSelectorComponent.js","Components/FallBacks/ProfileMissing.js","Components/Views/ContactsComponent.js","Components/ResourceMissingComponent.js","Components/ProfileCardErrorWrapper.js","Components/Views/UploadComponent.js","Components/Documents/AsyncListItemComment.js","Components/Documents/CommentAddComponent.js","Components/Documents/CommentsSidebar.js","Components/Documents/AccessControlTable.js","Components/Documents/AccessController.js","Components/Documents/DocumentInfoViewer.js","util/MellonUtils/notifications.js","Components/SubscriptionComponent.js","HOC/withContent.js","util/Util.js","Components/NavBarWrapper.js","App.js","Components/Help/HelpContainerComponent.js","serviceWorker.js","index.js","../../../src/Utils/util.ts","css/components/documentinfo.module.css","../../../src/Retrieval/retrieval.ts","../../../src/Validation/Validation.ts","../../../src/Retrieval/inbox_retrieval.ts","../../src/index.ts","../../src/NotificationHandler.ts"],"names":["module","exports","this","console","level","Level","logger","parseResponseToStore","id","response","aliases","EventEmitter","require","f","agent","ldnAgent","NotificationHandler","auth","notify","inboxMap","getInboxAgent","webId","InboxAgent","initializeAgent","a","notifications","watchNotifications","then","iterator","on","notification","read","JSON","quadArrayToString","quads","jsonld","parse","concat","emit","idsToDelete","clearNotifications","notificationIds","filter","indexOf","params","sendNotification","useNotifications","useState","setNotifications","useEffect","acl","arg","as","cal","cert","contact","dc","dct","doap","foaf","http","httph","icalTZ","ldp","link","log","meeting","mo","owl","pad","patch","prov","qu","trip","rdf","rdfs","rss","sched","schema","sioc","solid","space","stat","tab","tabont","ui","vcard","wf","xsd","cco","hydra","dbo","ldes","ex","ns","namedNode","u","namespaces","alias","expansion","localName","vocab","data","default","QueryEngine","instance","getInstance","getVal","getValArray","arr","args","length","results","slice","resultValues","result","push","value","error","clearCache","documentId","split","mime","getContentType","URI","getType","patchFile","body","doRequest","putFile","headers","postFile","requestType","showPopups","options","method","fetch","code","status","validStatusCodes","showErrorPopup","Error","statusCode","alert","window","getError","requestBody","ResourceMissingError","CustomError","message","irc","MODES","AccessControlList","COMMENT","createPermission","modes","people","agents","createACL","docURI","permissions","ACL","reCreateACL","deleteACL","getPermissions","getDocumentsCollection","getPublicationIds","publications","documentsMetadata","entries","getPublicationData","stringify","publication","type","title","keywords","authors","date","abstract","file","lifecycleEvents","Date","retrieveLDESEventIds","getResourceAsStore","store","getQuads","assertion","eventIds","map","q","object","retrieveEvent","event","created_at","token","retrieveLDESEvents","events","eventId","Promise","all","createPublicationTTLResource","documentMetadata","documentURI","eventStreamURI","join","createCollectionPatchBody","publicationResourceId","collectionId","getPublicationURIs","location","endsWith","fileNameBaseFolder","name","rootURI","publicationDocumentURI","publicationURI","createPublicationIdentifier","eventStreamFolderURI","artefactURI","extention","checkAndThrowErrors","uploadPublication","submission","publicationIds","documentPut","publicationRDFResource","publicationPut","FolderMetadataBody","eventStreamMetadataPut","patchBody","READ","WRITE","createLifecycleEvent","eventpostbody","eventpost","getDocumentMetadataId","documentsAndMetadata","documentIds","e","metadataId","eventType","toISOString","createComment","commentData","reply_of","has_creator","content","node","createAndPostComment","commentbody","postresponse","relativeCommentLocation","Object","fromEntries","absoluteCommentLocation","getBaseIRI","NotificationsViewerComponent","props","NotificationCard","useHistory","notificationObject","notificationProperties","property","className","Row","key","prop","Col","md","sortednotifications","sort","b","index","fetchProfile","bdate","contacts","followProfile","profileWebId","unfollowProfile","getCollectionId","createCollection","useProfile","profile","setProfile","liveUpdate","useLiveUpdate","mounted","getProfile","profileProps","ProfileViewerComponent","selectedWebId","keys","formatDate","Button","onClick","navigator","clipboard","writeText","setview","availableViews","profileeditor","DataFactory","literal","quad","variable","createDeleteInsertProfileDataQuery","oldprofile","newprofile","deleteClause","insertClause","deleteClauseString","insertClauseString","whereClauseString","ProfileEditorComponent","useForm","defaultValues","register","handleSubmit","reset","control","onSubmit","label","controller","ref","required","HelpComponent","LoginComponent","LoginButton","popup","FeedComponent","ProfileNameView","userProfile","ArtefactCard","publicationData","history","fields","styles","container","style","route","routeViewWithParams","documentinfo","open","Array","isArray","profilecardrow","toLocaleString","href","getStrVal","DocumentsViewerComponent","ownerWebId","foundPublications","setFoundPublications","publicationId","resolve","reject","ProfileCardComponent","unfollow","sm","showButtons","documents","feed","item","to","pathname","target","search","Tooltip","IconButton","aria-label","icon","ProfileCardSelectorComponent","webIdInput","setWebIdInput","isProfile","warnings","undefined","getWarnings","follow","Input","placeholder","onChange","color","ProfileMissing","ContactsComponent","Grid","spacing","xs","ResourceMissingComponent","ProfileCardErrorWrapper","setprofile","fetchAndSetProfile","fetched","timer","setTimeout","clearTimeout","UploadComponent","defaultlocation","substr","watch","useFieldArray","keywordsfields","keywordsappend","append","keywordsremove","remove","authorsfields","authorsappend","authorsremove","val","k","validateSubmission","checkAndInitializeCollection","Profile","useWatch","author","disabled","AsyncListItemComment","comment","replyOf","createdAt","creator","note","creatorName","state","timeString","paperMetadata","values","selection","header","ListItem","ListItemText","primary","secondary","Fragment","Typography","component","variant","Divider","CommentAddComponent","CommentsSidebar","commentIds","commentDates","setstate","updateDate","updateObj","newCommentDates","i","idsWithDates","commentId","getDateForId","getTime","commentsList","sidebarheight","List","commentslist","addcommentfield","EditableCell","initialValue","row","column","updateMyData","React","setValue","onBlur","t_value","trim","toLowerCase","CheckboxCell","checked","RemoveRowCell","removeRow","CheckBoxHeader","checkAll","setChecked","toUpperCase","AccessControlTable","tableData","submitValues","columns","useMemo","Header","accessor","Cell","defaultColumn","setData","useTable","rowIndex","columnId","old","splice","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","headerGroup","getHeaderGroupProps","getHeaderProps","render","getRowProps","cells","cell","getCellProps","write","AccessController","commentPermissions","submissionMessage","setSubmissionMessage","fetchData","newState","createTableData","agentIndexes","newRow","processPermission","permission","mode","includes","APPEND","addPermission","CONTROL","DocumentInfoViewer","userwebId","setPublicationData","setPublicationEvents","toPublications","height","publicationInfo","getRepresentation","createFollowEventNotification","objects","notif","topic","SubscriptionCreateComponent","makeStyles","theme","formControl","margin","minWidth","selectEmpty","marginTop","dividerDiv","errors","subscriptionObject","Subscription","url","SubscriptionTopic","ARTEFACTID","AUHTORID","KEYWORD","TITLE","SubscriptionComponent","addSubView","setAddSubView","subscriptions","setSubscriptions","submitSubscription","subscription","contentType","contentTypeOutput","newstate","removeSubscription","s","Math","round","random","withContent","initview","popupmessage","withWebId","view","URLSearchParams","hash","get","newProps","generation","LiveUpdate","login","newtab","help","missing","upload","listsub","dd","String","getDate","padStart","getMonth","getFullYear","IRI","path","replace","substring","paramString","drawerWidth","useStyles","root","display","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","marginLeft","width","enteringScreen","menuButton","marginRight","hide","flexShrink","whiteSpace","drawerOpen","drawerClose","overflowX","breakpoints","up","toolbar","alignItems","justifyContent","padding","mixins","flexGrow","NavBarWrapper","setOpen","sidebarComponents","sideBarItems","itemName","textDecoration","button","ListItemIcon","getSidebarComponent","topbarComponents","topBarItems","MenuItem","getTopBarComponent","classes","useTheme","CssBaseline","AppBar","position","clsx","Toolbar","edge","noWrap","hidelogout","LogoutButton","Drawer","paper","direction","fill","LoggedOut","exact","LoggedIn","viewId","NotificationsMenuItem","Badge","badgeContent","App","loginviewcomponents","defaultview","mainviewcomponents","defaultView","document","HelpContainerComponent","Boolean","hostname","match","ReactDOM","getElementById","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.b46208d9.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"profilecard_container__4R2nr\",\"propertylabel\":\"profilecard_propertylabel__FjYnN\",\"valuelabel\":\"profilecard_valuelabel__k0k0Y\",\"listitem\":\"profilecard_listitem__C-fpw\",\"rowcontainer\":\"profilecard_rowcontainer__NIioM\",\"profilecardrow\":\"profilecard_profilecardrow__3eJ5U\"};","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SystemNotificationHander = void 0;\nconst browser_or_node_1 = require(\"browser-or-node\");\nclass SystemNotificationHander {\n    constructor() {\n        this.notifier = browser_or_node_1.isBrowser\n            ? new BrowserNotifier()\n            : require('node-notifier');\n    }\n    notify(args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return yield this.notifier.notify(args);\n        });\n    }\n}\nexports.SystemNotificationHander = SystemNotificationHander;\nclass BrowserNotifier {\n    notify(args) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return new Promise((resolve, reject) => {\n                if (!window) {\n                    reject(\"Could not find window object in browser environment\");\n                }\n                // Check if the user agreed to get notified\n                if (window.Notification && Notification.permission === \"granted\") {\n                    var n = new Notification(args.title, { body: args.message });\n                    resolve(n);\n                }\n                // The user hasn't told if he wants to be notified or not, and has not yet been explicitly denied\n                // Note: because of Chrome, we are not sure the permission property is set, therefore it's unsafe to check for the \"default\" value.\n                else if (window.Notification && Notification.permission !== \"denied\") {\n                    Notification.requestPermission(function (status) {\n                        // If the user said okay\n                        if (status === \"granted\") {\n                            var n = new Notification(args.title, { body: args.message });\n                            resolve(n);\n                        }\n                        else {\n                            reject(\"User has not accepted notifications for this site.\");\n                        }\n                    });\n                }\n                else {\n                    reject(\"User has not accepted notifications for this site.\");\n                }\n            });\n        });\n    }\n}\n//# sourceMappingURL=SystemNotificationhandler.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst util_1 = require(\"../Utils/util\");\nconst df = __importStar(require(\"@rdfjs/data-model\"));\nconst NameSpaces_1 = __importDefault(require(\"../NameSpaces\"));\nconst SolidError_1 = __importDefault(require(\"../Utils/SolidError\"));\nconst rdf_parse_1 = __importDefault(require(\"rdf-parse\"));\nconst FileUtils_1 = require(\"../Utils/FileUtils\");\nconst streamifyString = require('streamify-string');\nconst BASEIRI = \"urn:Notification\";\nfunction generateNotification(auth, config, notificationData) {\n    return __awaiter(this, void 0, void 0, function* () {\n        // Extract and parse the notification body\n        let notificationQuads = yield parseNotificationBody(auth, notificationData);\n        const sender = notificationData.from || config.sender;\n        const senders = Array.isArray(sender) ? sender : [sender];\n        // Add the from, to, cc and bcc fields \n        for (const id of senders || []) {\n            if (id)\n                notificationQuads.push(df.quad(df.namedNode(BASEIRI), df.namedNode(NameSpaces_1.default.dct('creator')), df.namedNode(id)));\n        }\n        for (const id of notificationData.to || []) {\n            if (id)\n                notificationQuads.push(df.quad(df.namedNode(BASEIRI), df.namedNode(NameSpaces_1.default.as('to')), df.namedNode(id)));\n        }\n        for (const id of notificationData.cc || []) {\n            if (id)\n                notificationQuads.push(df.quad(df.namedNode(BASEIRI), df.namedNode(NameSpaces_1.default.as('cc')), df.namedNode(id)));\n        }\n        for (const id of notificationData.bcc || []) {\n            if (id)\n                notificationQuads.push(df.quad(df.namedNode(BASEIRI), df.namedNode(NameSpaces_1.default.as('bcc')), df.namedNode(id)));\n        }\n        const contentType = notificationData.contentTypeOutput;\n        try {\n            return util_1.quadsToString(notificationQuads, contentType);\n        }\n        catch (e) {\n            throw new SolidError_1.default(`Error serializing notification body\\n${e.message}`, 'Serialization');\n        }\n    });\n}\nexports.default = generateNotification;\nfunction parseNotificationBody(auth, notificationData) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let notificationString;\n        // Try parsing the notification parameter, retrieving the notification file, or retrieving and completing the passed template.\n        try {\n            if (notificationData.notification) {\n                notificationString = notificationData.notification;\n            }\n            else if (notificationData.notification_file) {\n                notificationString = yield FileUtils_1.loadResourceText(auth, notificationData.notification_file);\n            }\n            else if (notificationData.notification_template && notificationData.notification_mapping) {\n                throw new Error('Templates have not yet been implemented in this version.');\n            }\n            else {\n                throw new SolidError_1.default('No valid notification was provided. Please use --help to find the available methods to pass a notification to the program.');\n            }\n            // Convert the notification into RDF quads. In the case of a plain text notification, wrap it as an activitystream2.0 content.\n            if (notificationData.contentType === \"text/plain\") {\n                return new Promise((resolve, reject) => { resolve(buildNotificationWithText(notificationString)); });\n            }\n            else {\n                const textStream = streamifyString(notificationString);\n                const parsedStream = rdf_parse_1.default.parse(textStream, { contentType: notificationData.contentType, baseIRI: BASEIRI });\n                return util_1.streamToQuads(parsedStream);\n            }\n        }\n        catch (e) {\n            throw new SolidError_1.default(`Could not parse the notification.\\n${e}`, e.name || \"Notification parsing\");\n        }\n    });\n}\nfunction buildNotificationWithText(text) {\n    return ([\n        df.quad(df.namedNode(BASEIRI), df.namedNode(NameSpaces_1.default.as('content')), df.literal(text, df.namedNode(NameSpaces_1.default.xsd('string'))))\n    ]);\n}\n//# sourceMappingURL=NotificationGenerator.js.map","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InboxRetrievalAsyncIterator = void 0;\nconst asynciterator_1 = require(\"asynciterator\");\nconst UpdateTracker_1 = require(\"../AutoUpdates/UpdateTracker\");\nconst FileUtils_1 = require(\"../Utils/FileUtils\");\nconst NameSpaces_1 = __importDefault(require(\"../NameSpaces\"));\nconst winston_1 = __importDefault(require(\"winston\"));\nconst retrieval_1 = require(\"../Retrieval/retrieval\");\nconst Validation_1 = require(\"../Validation/Validation\");\nconst util_1 = require(\"../Utils/util\");\nconst streamifyArray = require('streamify-array');\nclass InboxRetrievalAsyncIterator extends asynciterator_1.AsyncIterator {\n    constructor(auth, params) {\n        super();\n        this.params = params;\n        this.auth = auth;\n        this.values = new Array();\n        this.trackFolder();\n    }\n    read() {\n        if (this.closed)\n            return null;\n        return this.values.shift() || null;\n    }\n    trackFolder() {\n        return __awaiter(this, void 0, void 0, function* () {\n            let processedIds = [];\n            // Create the tracker\n            const tracker = new UpdateTracker_1.UpdateTracker(this.auth);\n            tracker.on('update', (e) => __awaiter(this, void 0, void 0, function* () {\n                // Inbox is updated\n                const inboxStore = yield FileUtils_1.getStoreFromFile(this.auth, this.params.inbox);\n                const contentIds = inboxStore.getQuads(this.params.inbox, NameSpaces_1.default.ldp('contains'), null, null).map(quad => quad.object.id);\n                // Get the new notification(s)\n                const newContentIds = contentIds.filter(id => processedIds.indexOf(id) === -1);\n                for (let notificationId of newContentIds) {\n                    const quads = yield FileUtils_1.getQuadArrayFromFile(this.auth, notificationId);\n                    const modifieds = inboxStore.getQuads(notificationId, NameSpaces_1.default.dct('modified'), null, null);\n                    const date = modifieds && modifieds.length !== 0\n                        ? new Date(modifieds[0].object.value)\n                        : undefined;\n                    if (!this.params.filters || this.params.filters.length === 0) {\n                        this.validatedNotification(notificationId, quads, util_1.DEFAULTFILTERNAME, date);\n                    }\n                    else {\n                        for (let filter of this.params.filters) {\n                            if (!filter.name)\n                                throw new Error('No name parameter set for used filter.');\n                            if (filter.shape)\n                                throw new Error('Shapes are currently not yet supported.');\n                            if (!filter.shapeFileURI)\n                                throw new Error('No shapeFileURI parameter set for filter.');\n                            // These have to be done every time, as the stream is consumed. (Is the dataset consumed? TODO:: check)\n                            const shapeDataset = yield retrieval_1.getResourceAsDataset(this.auth, filter.shapeFileURI);\n                            const notificationQuadStream = yield streamifyArray(quads.slice()); // Slicing is required, as else the array is consumed when running in the browser (but not when running in node?)\n                            const notificationDataset = yield retrieval_1.getDataset(notificationQuadStream);\n                            if (!(yield Validation_1.validate(notificationDataset, shapeDataset))) {\n                                // The notification matches the given filter\n                                this.validatedNotification(notificationId, quads, filter.name, date);\n                            }\n                        }\n                    }\n                }\n                processedIds = processedIds.concat(newContentIds);\n                this.emit('readable');\n            }));\n            // Subscribe the tracker\n            tracker.subscribe(this.params.inbox);\n        });\n    }\n    validatedNotification(notificationId, quads, filterName, date) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.values.push({ id: notificationId, quads: quads.slice(), filterName: filterName, date: date });\n            // Handle flags\n            if (this.params.notify) {\n                util_1.notifySystem(quads, this.params.systemNotificationFormat, filterName, date);\n            }\n            if (this.params.delete) {\n                try {\n                    yield FileUtils_1.deleteFile(this.auth, notificationId);\n                    winston_1.default.log('verbose', 'Deleted notification: ' + notificationId);\n                }\n                catch (e) {\n                    winston_1.default.log('error', 'Failed to delete notification: ' + notificationId);\n                }\n            }\n        });\n    }\n}\nexports.InboxRetrievalAsyncIterator = InboxRetrievalAsyncIterator;\n//# sourceMappingURL=InboxRetrievalAsyncIterator.js.map","\"use strict\";\n// Based on:\n// https://github.com/solid/react-components/blob/edc5f9295fbaf2ff88212303e8f6aa5ac7ee0164/src/UpdateTracker.js\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UpdateTracker = void 0;\nconst events_1 = require(\"events\");\nconst PollingTracker_1 = require(\"./PollingTracker\");\nconst WebSocketTracker_1 = require(\"./WebSocketTracker\");\nconst winston_1 = __importDefault(require(\"winston\"));\n// Wildcard for tracking all resources\nclass UpdateTracker extends events_1.EventEmitter {\n    constructor(auth) {\n        super();\n        this.trackers = new Map();\n        this.reconnectionAttempts = 0;\n        this.reconnectionDelay = 1000;\n        this.auth = auth;\n    }\n    track(url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const tracker = yield createTracker(this.auth, url);\n            tracker.on('update', () => {\n                const update = {\n                    timestamp: new Date(),\n                    url\n                };\n                this.emit('update', update);\n            });\n            tracker.on('close', () => {\n                this.trackers.delete(url); // Delete old tracker\n                this.reconnect(url); // Create new tracker\n            });\n            this.trackers.set(url, tracker);\n            tracker.watch();\n            return tracker;\n        });\n    }\n    // Todo :: graceful transition from websocket to polling\n    reconnect(url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // Try setting up a new socket\n            if (this.reconnectionAttempts < 6) {\n                // Wait a given backoff period before reconnecting\n                yield new Promise(done => (setTimeout(done, this.reconnectionDelay)));\n                // Try reconnecting, and back off exponentially\n                yield this.track(url);\n            }\n        });\n    }\n    /**\n     * Subscribes to changes in the given resources\n     * @param urls\n     */\n    subscribe(...urls) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (let url of urls) {\n                // Create a new subscription to the resource if none existed\n                url = url.replace(/#.*/, '');\n                // If we are not yet subscribed to this resource\n                if (!(url in this.trackers.keys())) {\n                    this.track(url);\n                }\n            }\n        });\n    }\n    /** Unsubscribes to changes in the given resources */\n    unsubscribe(...urls) {\n        return __awaiter(this, void 0, void 0, function* () {\n            for (let url of urls) {\n                url = url.replace(/#.*/, '');\n                const tracker = this.trackers.get(url);\n                if (tracker) {\n                    tracker.stop();\n                    this.trackers.delete(url);\n                }\n            }\n        });\n    }\n}\nexports.UpdateTracker = UpdateTracker;\nfunction getWebSocketUrl(auth, url) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const response = yield auth.fetch(url);\n        const webSocketUrl = response.headers.get('Updates-Via');\n        if (!webSocketUrl)\n            winston_1.default.log('verbose', `No WebSocket found for ${url}`);\n        return webSocketUrl;\n    });\n}\nfunction createTracker(auth, url) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const webSocketURL = yield getWebSocketUrl(auth, url);\n        if (webSocketURL) {\n            return new WebSocketTracker_1.WebSocketTracker(auth, url, webSocketURL);\n        }\n        else {\n            return new PollingTracker_1.PollingTracker(auth, url);\n        }\n    });\n}\n//# sourceMappingURL=UpdateTracker.js.map","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PollingTracker = void 0;\nconst FileUtils_1 = require(\"../Utils/FileUtils\");\nconst NameSpaces_1 = __importDefault(require(\"../NameSpaces\"));\nconst events_1 = require(\"events\");\nclass PollingTracker extends events_1.EventEmitter {\n    constructor(auth, url, timeOut = 5000) {\n        super();\n        this.interval = null;\n        this.processedIds = [];\n        this.auth = auth;\n        this.url = url;\n        this.timeOut = timeOut;\n    }\n    stop() {\n        if (this.interval) {\n            clearInterval(this.interval);\n        }\n    }\n    watch() {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.interval = setInterval(() => __awaiter(this, void 0, void 0, function* () {\n                this.evaluate();\n            }), this.timeOut);\n        });\n    }\n    evaluate() {\n        return __awaiter(this, void 0, void 0, function* () {\n            const quads = yield FileUtils_1.getQuadArrayFromFile(this.auth, this.url);\n            let updated = false;\n            for (let quad of quads) {\n                // Currently only checking contains as this is for notifications\n                if (quad.predicate.value === NameSpaces_1.default.ldp('contains')) {\n                    if (this.processedIds.indexOf(quad.object.value) === -1) {\n                        this.processedIds.push(quad.object.value);\n                        updated = true;\n                    }\n                }\n            }\n            if (updated) {\n                this.emit('update');\n            }\n        });\n    }\n}\nexports.PollingTracker = PollingTracker;\n//# sourceMappingURL=PollingTracker.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebSocketTracker = void 0;\nconst browser_or_node_1 = require(\"browser-or-node\");\nconst events_1 = require(\"events\");\nconst winston = __importStar(require(\"winston\"));\nclass WebSocketTracker extends events_1.EventEmitter {\n    constructor(auth, url, socketURI) {\n        super();\n        this.auth = auth;\n        this.url = url;\n        this.socketURI = socketURI;\n    }\n    stop() {\n        if (this.webSocket) {\n            this.webSocket.close();\n        }\n    }\n    createWebSocket() {\n        winston.log('verbose', 'creating websocket tracker for url: ' + this.socketURI);\n        return new Promise((resolve, reject) => {\n            let Socket = browser_or_node_1.isBrowser ? WebSocket : require('ws');\n            const ws = new Socket(this.socketURI);\n            ws.onopen = () => { resolve(ws); };\n            ws.onerror = () => { reject(); };\n        });\n    }\n    watch() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // emit an update, as there may be notifications already present\n            const tracker = this;\n            tracker.emit(\"update\");\n            const ws = yield this.createWebSocket();\n            ws.onmessage = function (e) {\n                // Verify the message is an update notification\n                const match = /^pub +(.+)/.exec(e.data);\n                if (!match)\n                    return;\n                // Notify the subscribers\n                tracker.emit(\"update\");\n            };\n            this.webSocket = ws;\n            ws.send(`sub ${this.url}`);\n        });\n    }\n}\nexports.WebSocketTracker = WebSocketTracker;\n//# sourceMappingURL=WebSocketTracker.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Level = exports.setLogOptions = exports.log = exports.Logger = void 0;\nclass Logger {\n    constructor() {\n        this.verbose = false;\n        this.cli = false;\n    }\n    static getInstance() {\n        if (!Logger._instance) {\n            Logger._instance = new Logger();\n        }\n        return Logger._instance;\n    }\n}\nexports.Logger = Logger;\nfunction log(level, message) {\n    const logger = Logger.getInstance();\n    if (level === Level.CLI) {\n        if (logger.cli || logger.verbose) {\n            console.log(message);\n        }\n    }\n    else if (level === Level.Log) {\n        if (logger.verbose) {\n            console.log(message);\n        }\n    }\n    else if (level === Level.Warn) {\n        console.warn(message);\n    }\n    else if (level === Level.Error) {\n        console.error(message);\n    }\n}\nexports.log = log;\nfunction setLogOptions(cli, verbose) {\n    const logger = Logger.getInstance();\n    if (cli)\n        logger.cli = true;\n    if (verbose)\n        logger.verbose = true;\n}\nexports.setLogOptions = setLogOptions;\nvar Level;\n(function (Level) {\n    Level[Level[\"CLI\"] = 0] = \"CLI\";\n    Level[Level[\"Log\"] = 1] = \"Log\";\n    Level[Level[\"Warn\"] = 2] = \"Warn\";\n    Level[Level[\"Error\"] = 3] = \"Error\";\n})(Level = exports.Level || (exports.Level = {}));\n//# sourceMappingURL=Logger.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst inbox_retrieval_1 = require(\"../Retrieval/inbox_retrieval\");\nconst FileUtils_1 = require(\"../Utils/FileUtils\");\nconst retrieval_1 = require(\"../Retrieval/retrieval\");\nconst Validation_1 = require(\"../Validation/Validation\");\nconst util_1 = require(\"../Utils/util\");\nconst winston_1 = __importDefault(require(\"winston\"));\nconst N3 = __importStar(require(\"n3\"));\nconst NameSpaces_1 = __importDefault(require(\"../NameSpaces\"));\nconst streamifyArray = require('streamify-array');\nfunction getInboxIterator(auth, params) {\n    var _a;\n    return __awaiter(this, void 0, void 0, function* () {\n        // Check if notifications are specified to be processed. If not, process over all notifications in the inbox.\n        const notificationIds = (_a = (yield inbox_retrieval_1.fetchInboxNotifications(auth, params.inbox))) === null || _a === void 0 ? void 0 : _a.notifications;\n        const notifications = [];\n        for (let id of notificationIds) {\n            const quads = yield FileUtils_1.getQuadArrayFromFile(auth, id);\n            const inboxStore = new N3.Store(quads.slice());\n            const modifieds = inboxStore.getQuads(id, NameSpaces_1.default.dct('modified'), null, null);\n            const date = modifieds && modifieds.length !== 0\n                ? new Date(modifieds[0].object.value)\n                : undefined;\n            if (!params.filters || params.filters.length === 0) {\n                const inboxNotification = { id, quads, filterName: util_1.DEFAULTFILTERNAME, date };\n                notifications.push(inboxNotification);\n            }\n            else {\n                for (let filter of params.filters || []) {\n                    if (!filter.name)\n                        throw new Error('No name parameter set for used filter.');\n                    if (filter.shape)\n                        throw new Error('Shapes are currently not yet supported.');\n                    if (!filter.shapeFileURI)\n                        throw new Error('No shapeFileURI parameter set for filter.');\n                    // These have to be done every time, as the stream is consumed. (Is the dataset consumed? TODO:: check)\n                    const shapeDataset = yield retrieval_1.getResourceAsDataset(auth, filter.shapeFileURI);\n                    const quadStream = yield streamifyArray(quads.slice()); // Slicing is required, as else the array is consumed when running in the browser (but not when running in node?)\n                    const notificationDataset = yield retrieval_1.getDataset(quadStream);\n                    if (!(yield Validation_1.validate(notificationDataset, shapeDataset))) {\n                        // The notification matches the given filter\n                        const inboxNotification = { id, quads, filterName: filter.name, date };\n                        notifications.push(inboxNotification);\n                        // Handle flags\n                        if (params.notify) {\n                            util_1.notifySystem(inboxNotification.quads, params.systemNotificationFormat, filter.name, date);\n                        }\n                        if (params.delete) {\n                            try {\n                                yield FileUtils_1.deleteFile(auth, inboxNotification.id);\n                                winston_1.default.log('verbose', 'Deleted notification: ' + inboxNotification.id);\n                            }\n                            catch (e) {\n                                winston_1.default.log('error', 'Failed to delete notification: ' + inboxNotification.id);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return makeIterator(notifications);\n    });\n}\nexports.default = getInboxIterator;\nfunction makeIterator(array) {\n    return array[Symbol.iterator]();\n}\n//# sourceMappingURL=InboxRetrievalIterator.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createFetchError = void 0;\n// This class is used from @inrupt/solid-react-components\nclass SolidError extends Error {\n    constructor(message, name, code) {\n        super(message);\n        this.message = message;\n        this.statusText = message;\n        this.name = name || 'SolidError';\n        this.type = this.name;\n        this.code = code || 0;\n        this.status = code || 0;\n    }\n}\nexports.default = SolidError;\nexports.createFetchError = (code, name) => {\n    switch (code) {\n        case 400:\n            return new SolidError(`Bad request sent by client`, name, code);\n        case 401:\n            return new SolidError(`Client is unauthorized to access this resource`, name, code);\n        case 403:\n            return new SolidError(`Client is forbidden from accessing this resource`, name, code);\n        case 404:\n            return new SolidError(`Resource was not found`, name, code);\n        default:\n            if (code >= 200 && code < 300) {\n                return new SolidError(`Expected resource to return code 200, but received code ${code}`, name, code);\n            }\n            else if (code >= 300 && code < 400) {\n                return new SolidError(`Resource has been redirected`, name, code);\n            }\n            else if (code >= 400 && code < 500) {\n                return new SolidError(`Error with client request`, name, code);\n            }\n            else if (code >= 500 && code < 600) {\n                return new SolidError(`Internal server error. ${code}`, name, code);\n            }\n            break;\n    }\n};\n//# sourceMappingURL=SolidError.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getStoreFromFile = exports.getQuadArrayFromFile = exports.parseResponseToQuads = exports.parseResponseToStore = exports.deleteFile = exports.postFile = exports.getFile = exports.loadResourceText = void 0;\nconst SolidError_1 = __importDefault(require(\"./SolidError\"));\nconst NameSpaces_1 = __importDefault(require(\"../NameSpaces\"));\nconst N3 = __importStar(require(\"n3\"));\nconst rdf_parse_1 = __importDefault(require(\"rdf-parse\"));\nconst SolidError_2 = require(\"./SolidError\");\nconst browser_or_node_1 = require(\"browser-or-node\");\nconst fs_1 = require(\"fs\");\nconst util_1 = require(\"./util\");\nconst winston_1 = __importDefault(require(\"winston\"));\nconst streamifyString = require('streamify-string');\nconst INBOX_LINK_REL = NameSpaces_1.default.ldp('inbox');\n// TODO: ADD AUTHORIZATION HEADERS BASED ON SENDER AND CURRENT AUTH\n// Authorization: \"Bearer \"\nfunction loadResourceText(auth, path) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let remoteURL = true;\n        try {\n            new URL(path);\n        }\n        catch (e) {\n            remoteURL = false;\n        }\n        if (remoteURL) {\n            const response = yield getFile(auth, path, \"Loading resource\");\n            return yield response.text();\n        }\n        else {\n            if (browser_or_node_1.isBrowser) {\n                throw new Error('Local file paths in a browser environment are not yet supported');\n            }\n            else {\n                return (yield fs_1.readFileSync(path, { encoding: 'utf-8' }));\n            }\n        }\n    });\n}\nexports.loadResourceText = loadResourceText;\nfunction getFile(auth, uri, operationName) {\n    return __awaiter(this, void 0, void 0, function* () {\n        winston_1.default.log('verbose', 'getting ' + uri);\n        const headers = { Link: \"<meta.rdf>;rel=\" + INBOX_LINK_REL };\n        const response = yield fetch(auth, uri, {\n            method: 'GET',\n            headers,\n        }, operationName);\n        if (!response) {\n            throw new SolidError_1.default(`An error happened during the ${'GET'} operation on resource: ${uri}`, operationName);\n        }\n        else if (response.status !== 200) {\n            throw SolidError_2.createFetchError(response.status, operationName);\n        }\n        return response;\n    });\n}\nexports.getFile = getFile;\nfunction postFile(auth, uri, body, contentType, operationName) {\n    return __awaiter(this, void 0, void 0, function* () {\n        winston_1.default.log('verbose', 'posting ' + uri + 'with' + body);\n        const headers = { 'Content-Type': contentType };\n        const response = yield fetch(auth, uri, {\n            method: 'POST',\n            headers,\n            body,\n        }, operationName);\n        if (!response) {\n            throw new SolidError_1.default(`An error happened during the ${\"Post\"} operation on resource: ${uri}`, operationName);\n        }\n        else if (response.status !== 201 || response.status === 202) {\n            throw SolidError_2.createFetchError(response.status, operationName);\n        }\n        return response;\n    });\n}\nexports.postFile = postFile;\nfunction deleteFile(auth, uri, operationName) {\n    return __awaiter(this, void 0, void 0, function* () {\n        winston_1.default.log('verbose', 'deleting ' + uri);\n        const response = yield fetch(auth, uri, {\n            method: 'DELETE',\n        }, operationName);\n        if (!response) {\n            throw new SolidError_1.default(`An error happened during the ${'DELETE'} operation on resource: ${uri}`, operationName);\n        }\n        else if (response.status !== 200) {\n            throw SolidError_2.createFetchError(response.status, operationName);\n        }\n        return response;\n    });\n}\nexports.deleteFile = deleteFile;\nfunction fetch(auth, uri, options, operationName) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (!auth)\n            throw new SolidError_1.default('Please make sure the user is authenticated.', 'User not authenticated');\n        try {\n            return yield auth.fetch(uri, options);\n        }\n        catch (e) {\n            throw new SolidError_1.default(e.message, \"Fetch error\");\n        }\n    });\n}\nfunction parseResponseToStore(id, response) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const content_type = response.headers.get('content-type');\n        if (!content_type)\n            throw new SolidError_1.default('Cannot parse server response. Server response did not contain a content-type header.');\n        // TODO:: TRY TO GUESS CONTENT TYPE / LOOK AT FILE EXTENSION?\n        const responseText = yield response.text();\n        const textStream = yield streamifyString(responseText);\n        try {\n            return new Promise((resolve, reject) => {\n                const store = new N3.Store();\n                rdf_parse_1.default.parse(textStream, { contentType: content_type, baseIRI: id })\n                    .on('data', (quad) => { store.addQuad(quad); })\n                    .on('error', (error) => reject(error))\n                    .on('end', () => resolve(store));\n            });\n        }\n        catch (e) {\n            throw new SolidError_1.default(`Error parsing resource at ${response.url} \\n ${e.message}`, 'ParseError');\n        }\n    });\n}\nexports.parseResponseToStore = parseResponseToStore;\nfunction parseResponseToQuads(response) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const content_type = response.headers.get('content-type');\n        if (!content_type)\n            throw new SolidError_1.default('Cannot parse server response. Server response did not contain a content-type header.');\n        // TODO:: TRY TO GUESS CONTENT TYPE / LOOK AT FILE EXTENSION?\n        try {\n            return new Promise((resolve, reject) => {\n                const quads = [];\n                const inputStream = util_1.toReadableStream(response.body);\n                rdf_parse_1.default.parse(inputStream, { contentType: content_type })\n                    .on('data', (quad) => quads.push(quad))\n                    .on('error', (error) => reject(error))\n                    .on('end', () => resolve(quads));\n            });\n        }\n        catch (e) {\n            throw new SolidError_1.default(`Error parsing resource at ${response.url} \\n ${e.message}`, 'ParseError');\n        }\n    });\n}\nexports.parseResponseToQuads = parseResponseToQuads;\nfunction getQuadArrayFromFile(auth, id) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const response = yield getFile(auth, id);\n        return parseResponseToQuads(response);\n    });\n}\nexports.getQuadArrayFromFile = getQuadArrayFromFile;\nfunction getStoreFromFile(auth, id) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const response = yield getFile(auth, id);\n        return parseResponseToStore(id, response);\n    });\n}\nexports.getStoreFromFile = getStoreFromFile;\n//# sourceMappingURL=FileUtils.js.map","\"use strict\";\n/* eslint-disable no-unused-vars */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * Provides a way to access commonly used namespaces\n *\n * Usage:\n *\n *   ```\n *   const $rdf = require('rdflib'); //or any other RDF/JS-compatible library\n *   const ns = require('solid-namespace')($rdf);\n *   const store = $rdf.graph();\n *\n *   let me = ...;\n *   let name = store.any(me, ns.vcard(‘fn’)) || store.any(me, ns.foaf(‘name’));\n *   ```\n * @module vocab\n */\nvar aliases;\n(function (aliases) {\n    aliases[\"acl\"] = \"http://www.w3.org/ns/auth/acl#\";\n    aliases[\"arg\"] = \"http://www.w3.org/ns/pim/arg#\";\n    aliases[\"as\"] = \"https://www.w3.org/ns/activitystreams#\";\n    aliases[\"cal\"] = \"http://www.w3.org/2002/12/cal/ical#\";\n    aliases[\"cert\"] = \"http://www.w3.org/ns/auth/cert#\";\n    aliases[\"contact\"] = \"http://www.w3.org/2000/10/swap/pim/contact#\";\n    aliases[\"dc\"] = \"http://purl.org/dc/elements/1.1/\";\n    aliases[\"dct\"] = \"http://purl.org/dc/terms/\";\n    aliases[\"doap\"] = \"http://usefulinc.com/ns/doap#\";\n    aliases[\"foaf\"] = \"http://xmlns.com/foaf/0.1/\";\n    aliases[\"http\"] = \"http://www.w3.org/2007/ont/http#\";\n    aliases[\"httph\"] = \"http://www.w3.org/2007/ont/httph#\";\n    aliases[\"icalTZ\"] = \"http://www.w3.org/2002/12/cal/icaltzd#\";\n    aliases[\"ldp\"] = \"http://www.w3.org/ns/ldp#\";\n    aliases[\"link\"] = \"http://www.w3.org/2007/ont/link#\";\n    aliases[\"log\"] = \"http://www.w3.org/2000/10/swap/log#\";\n    aliases[\"meeting\"] = \"http://www.w3.org/ns/pim/meeting#\";\n    aliases[\"mo\"] = \"http://purl.org/ontology/mo/\";\n    aliases[\"owl\"] = \"http://www.w3.org/2002/07/owl#\";\n    aliases[\"pad\"] = \"http://www.w3.org/ns/pim/pad#\";\n    aliases[\"patch\"] = \"http://www.w3.org/ns/pim/patch#\";\n    aliases[\"prov\"] = \"http://www.w3.org/ns/prov#\";\n    aliases[\"qu\"] = \"http://www.w3.org/2000/10/swap/pim/qif#\";\n    aliases[\"trip\"] = \"http://www.w3.org/ns/pim/trip#\";\n    aliases[\"rdf\"] = \"http://www.w3.org/1999/02/22-rdf-syntax-ns#\";\n    aliases[\"rdfs\"] = \"http://www.w3.org/2000/01/rdf-schema#\";\n    aliases[\"rss\"] = \"http://purl.org/rss/1.0/\";\n    aliases[\"sched\"] = \"http://www.w3.org/ns/pim/schedule#\";\n    aliases[\"schema\"] = \"http://schema.org/\";\n    aliases[\"sioc\"] = \"http://rdfs.org/sioc/ns#\";\n    aliases[\"solid\"] = \"http://www.w3.org/ns/solid/terms#\";\n    aliases[\"space\"] = \"http://www.w3.org/ns/pim/space#\";\n    aliases[\"stat\"] = \"http://www.w3.org/ns/posix/stat#\";\n    aliases[\"tab\"] = \"http://www.w3.org/2007/ont/link#\";\n    aliases[\"tabont\"] = \"http://www.w3.org/2007/ont/link#\";\n    aliases[\"ui\"] = \"http://www.w3.org/ns/ui#\";\n    aliases[\"vcard\"] = \"http://www.w3.org/2006/vcard/ns#\";\n    aliases[\"wf\"] = \"http://www.w3.org/2005/01/wf/flow#\";\n    aliases[\"xsd\"] = \"http://www.w3.org/2001/XMLSchema#\";\n    aliases[\"cco\"] = \"http://www.ontologyrepository.com/CommonCoreOntologies/\";\n    aliases[\"dbo\"] = \"http://dbpedia.org/ontology/\";\n    aliases[\"ex\"] = \"http://example.com/\";\n    aliases[\"tree\"] = \"https://w3id.org/tree#\";\n    aliases[\"hydra\"] = \"http://www.w3.org/ns/hydra/core#\";\n    aliases[\"void\"] = \"http://rdfs.org/ns/void#\";\n    aliases[\"shacl\"] = \"http://www.w3.org/ns/shacl#\";\n})(aliases || (aliases = {}));\n/**\n * @param [rdflib] {RDF} Optional RDF Library (such as rdflib.js or rdf-ext) to inject\n */\nconst vocab = function (rdf = { namedNode: (u) => u }) {\n    const namespaces = {};\n    for (const alias in aliases) {\n        const expansion = aliases[alias];\n        namespaces[alias] = function (localName = '') {\n            return rdf.namedNode(expansion + localName);\n        };\n    }\n    ;\n    return namespaces;\n};\nconst ns = vocab();\nexports.default = ns;\n//# sourceMappingURL=NameSpaces.js.map","const EventEmitter = require('events');\nconst f = require('@dexagod/rdf-retrieval')\nconst ldnAgent = require('@dexagod/ldn-agent').NotificationHandler\nconst auth = require('solid-auth-client')\nvar agent = new ldnAgent({auth, notify: true})\n\nvar inboxMap = {}\n\n\nexport function getInboxAgent(webId) {\n  if (!inboxMap[webId]) {\n    inboxMap[webId] = new InboxAgent(webId);\n  } \n  return inboxMap[webId]\n}\n\nclass InboxAgent extends EventEmitter  {\n  constructor(webId) {\n    super()\n    this.webId = webId;\n    this.initializeAgent(webId)\n  }\n\n  async initializeAgent(webId) {\n    this.notifications = []\n    agent.watchNotifications({webId}).then(iterator => {\n\n      iterator.on('readable', async () => {\n        let notification;\n        while (notification = iterator.read()) {\n          notification.jsonld = JSON.parse(await f.quadArrayToString(notification.quads, 'application/ld+json'))\n          this.notifications = [notification].concat(this.notifications)\n          this.emit('notifications', this.notifications)\n        }\n          \n      });\n    })\n  }\n\n  deleteNotification(idsToDelete) {\n    agent.clearNotifications({webId: this.webId, notificationIds: idsToDelete})\n    this.notifications = this.notifications.filter(notification => idsToDelete.indexOf(notification.id) === -1)\n    this.emit('notifications', this.notifications)\n  }\n\n  async sendNotification(params) {\n    agent.sendNotification(params)\n  }\n}\n\n  ","import { useState, useEffect } from 'react';\nimport { getInboxAgent } from 'singletons/InboxAgent';\n\nconst useNotifications = function(webId, showSystemNotification = false) {\n  const [notifications, setNotifications] = useState([]);\n  var agent = null;\n  useEffect(() => {\n    agent = getInboxAgent(webId);\n    agent.on('notifications', (notifications) => setNotifications(notifications)) \n    return () => {\n      agent = null\n    }\n  }, [webId])  \n  return notifications;\n}\n\n\nexport default useNotifications\n","/**\n * Provides a way to access commonly used namespaces\n *\n * Usage:\n *\n *   ```\n *   const $rdf = require('rdflib'); //or any other RDF/JS-compatible library\n *   const ns = require('solid-namespace')($rdf);\n *   const store = $rdf.graph();\n *\n *   let me = ...;\n *   let name = store.any(me, ns.vcard(‘fn’)) || store.any(me, ns.foaf(‘name’));\n *   ```\n * @module vocab\n */\nconst aliases = {\n  acl: 'http://www.w3.org/ns/auth/acl#',\n  arg: 'http://www.w3.org/ns/pim/arg#',\n  as: 'https://www.w3.org/ns/activitystreams#',\n  cal: 'http://www.w3.org/2002/12/cal/ical#',\n  cert: 'http://www.w3.org/ns/auth/cert#',\n  contact: 'http://www.w3.org/2000/10/swap/pim/contact#',\n  dc: 'http://purl.org/dc/elements/1.1/',\n  dct: 'http://purl.org/dc/terms/',\n  doap: 'http://usefulinc.com/ns/doap#',\n  foaf: 'http://xmlns.com/foaf/0.1/',\n  http: 'http://www.w3.org/2007/ont/http#',\n  httph: 'http://www.w3.org/2007/ont/httph#',\n  icalTZ: 'http://www.w3.org/2002/12/cal/icaltzd#', // Beware: not cal:\n  ldp: 'http://www.w3.org/ns/ldp#',\n  link: 'http://www.w3.org/2007/ont/link#',\n  log: 'http://www.w3.org/2000/10/swap/log#',\n  meeting: 'http://www.w3.org/ns/pim/meeting#',\n  mo: 'http://purl.org/ontology/mo/',\n  owl: 'http://www.w3.org/2002/07/owl#',\n  pad: 'http://www.w3.org/ns/pim/pad#',\n  patch: 'http://www.w3.org/ns/pim/patch#',\n  prov: 'http://www.w3.org/ns/prov#',\n  qu: 'http://www.w3.org/2000/10/swap/pim/qif#',\n  trip: 'http://www.w3.org/ns/pim/trip#',\n  rdf: 'http://www.w3.org/1999/02/22-rdf-syntax-ns#',\n  rdfs: 'http://www.w3.org/2000/01/rdf-schema#',\n  rss: 'http://purl.org/rss/1.0/',\n  sched: 'http://www.w3.org/ns/pim/schedule#',\n  schema: 'http://schema.org/', // @@ beware confusion with documents no 303\n  sioc: 'http://rdfs.org/sioc/ns#',\n  solid: 'http://www.w3.org/ns/solid/terms#',\n  space: 'http://www.w3.org/ns/pim/space#',\n  stat: 'http://www.w3.org/ns/posix/stat#',\n  tab: 'http://www.w3.org/2007/ont/link#',\n  tabont: 'http://www.w3.org/2007/ont/link#',\n  ui: 'http://www.w3.org/ns/ui#',\n  vcard: 'http://www.w3.org/2006/vcard/ns#',\n  wf: 'http://www.w3.org/2005/01/wf/flow#',\n  xsd: 'http://www.w3.org/2001/XMLSchema#',\n  cco: 'http://www.ontologyrepository.com/CommonCoreOntologies/',\n\n  hydra: \"http://www.w3.org/ns/hydra/core#\",\n  dbo: 'http://dbpedia.org/ontology/',\n  ldes: 'https://w3id.org/ldes#',\n  \n  ex: 'https://www.example.org/ontology#',\n}\n\n\n/**\n * @param [rdflib] {RDF} Optional RDF Library (such as rdflib.js or rdf-ext) to inject\n */\nconst vocab = function (rdf = { namedNode: u => u }) {\n  const namespaces = {}\n  for (const alias in aliases) {\n    const expansion = aliases[alias]\n    namespaces[alias] = function (localName = '') {\n      return rdf.namedNode(expansion + localName)\n    }\n  };\n\n  return namespaces\n};\n\nconst ns = vocab()\nexport default ns ","const { default: data } = require('@solid/query-ldflex');\nvar QueryEngine = (function () {\n  var instance;\n  const createInstance = () => data\n  return {\n      getInstance: function () {\n          if (!instance) {\n              instance = createInstance();\n          }\n          return instance;\n      }\n  };\n})();\n\n\nexport async function getVal(...args) {\n  const arr = await getValArray(...args);\n  return arr && arr[0]\n}\n\nexport async function getValArray(...args) {\n  try {\n    const data = QueryEngine.getInstance();\n    if(!args || args.length === 0) return null;\n    let results = data[args[0]];\n    for (let arg of args.slice(1)) {\n      if (!arg) return null\n      results = results[arg]\n    }\n    const resultValues = []\n    for await (const result of results) {\n      resultValues.push(result.value)\n    }\n    return resultValues\n  } catch (e) {\n    console.error(e)\n    return null;\n  }\n}\n\nexport async function clearCache(documentId) {\n  const data = QueryEngine.getInstance();\n  await data.clearCache(documentId.split('#')[0])\n}","import { validStatusCodes } from './Util'\nimport { clearCache } from '../singletons/QueryEngine';\nconst auth = require('solid-auth-client')\nconst DEFAULTSHOWPOPUPS = false;\nconst FileClient = require(\"solid-file-client\");\nconst mime = require('mime');\n\n// TODO: automatically create directories using solid-file-client\n\nconst getContentType = (URI) => {\n  return mime.getType(URI.split('#')[0]) || 'text/turtle'\n}\n\n// export async function getFile(URI) {\n//   return doRequest('GET', URI, null, null)\n// }\n\nexport async function patchFile(URI, body) {\n  clearCache(URI);\n  return doRequest('PATCH', URI, body, { \"Content-Type\": \"application/sparql-update\" })\n}\n\nexport async function putFile(URI, body, headers) {\n  clearCache(URI);\n  return doRequest('PUT', URI, body, headers || { \"Content-Type\": getContentType(URI) })\n}\n\nexport async function postFile(URI, body, headers) {\n  clearCache(URI);\n  return doRequest('POST', URI, body, headers || { \"Content-Type\": getContentType(URI) })\n}\n\nexport async function deleteFile(URI) {\n  clearCache(URI);\n  return doRequest('DELETE', URI)\n}\n\nasync function doRequest(requestType, URI, body, headers, showPopups) {\n  try {\n    const options = {method: requestType}\n    if (body) options.body = body\n    if (headers) options.headers = headers\n    const response = await auth.fetch(URI, options);\n    const code = (await response).status\n    if (validStatusCodes.indexOf(code) === -1) {\n      showErrorPopup(URI, code, requestType, showPopups)\n    }\n    return response;\n  } catch (e) {\n    throw new Error(`Error during ${requestType} operation on ${URI}`)\n    return null;\n  }\n  \n}\n\nfunction showErrorPopup(URI, statusCode, requestType, showPopups) {\n  let alert = null\n  if ([401, 403].indexOf(statusCode) !== -1) {\n    alert =`Incorrect authorization during ${requestType} request to resource on ${URI}. Please double check the permissions set in your solid pod!`\n  } else if ([404].indexOf(statusCode) !== -1) {\n    alert =`Could not do ${requestType} request to resource at ${URI}, as it has been removed or does not exist.`\n  } else {\n    alert =`Could not do ${requestType} request to resource at ${URI}. Please double check the permissions set in your solid pod!`\n  }\n  if (alert && showPopups) window.alert(alert)\n  else if (alert) console.error(alert)\n}\n\nexport async function fileExists(fileURL) {\n  const fc = new FileClient(auth);\n  return fc.itemExists(fileURL);\n}\n\nexport function parse_link_header(result) {\n  if (!result || !result.headers) return null;\n  const header = Object.fromEntries(result.headers).link\n  if (!header || header.length === 0) return null;\n\n  // Split parts by comma\n  var parts = header.split(',');\n  var links = {};\n  // Parse each part into a named link\n  for(var i=0; i<parts.length; i++) {\n      var section = parts[i].split(';');\n      if (section.length !== 2) {\n          throw new Error(\"section could not be split on ';'\");\n      }\n      var url = section[0].replace(/<(.*)>/, '$1').trim();\n      var name = section[1].replace(/rel=\"(.*)\"/, '$1').trim();\n      links[name] = url;\n  }\n  return links;\n}\n","const getError = (URI, response, requestBody) => {\n  const code = response && response.code\n  if (code === 404 || 500) {\n    return new ResourceMissingError(URI, response, requestBody)\n  } else if (code === 401 || code === 403) {\n    return new PermissionError(URI, response, requestBody)\n  } else if (code === 409) {\n    return new UpdateError(URI, response, requestBody)\n  } else {\n    return new DefaultRequestError(URI, response, requestBody)\n  }\n}\n\nclass CustomError extends Error {\n  constructor(response, body, message) {\n    super(message)\n    this.response = response;\n    this.requestBody = body;\n  }\n}\n\n\n/**\n * Error to throw if update is not executed because of \n */\nclass ResourceMissingError extends CustomError {\n  constructor(URI, response, body) {\n    const message = `Resource at location ${URI} has been removed or does not exist.`\n    super(response, body, message)\n  }\n}\n\n\n/**\n * Error to throw if update is not executed because of incorrect update with regards to server state\n */\nclass UpdateError extends CustomError {\n  constructor(URI, response, body) {\n    const message = `Could not update the resource at location ${URI}. Please refresh the page and try again.`\n    super(response, body, message)\n  }\n}\n\nclass PermissionError extends CustomError {\n  constructor(URI, response, body) {\n    const message = `The current logged in user does not have adequate permission for the interaction with the resource at location ${URI}. Please check that all required permissions are set correctly.`\n    super(response, body, message)\n  }\n}\n\nclass DefaultRequestError extends CustomError {\n  constructor(URI, response, body) {\n    const message = `The current operation for the resource at location ${URI} could not be done. Please restart the application and try again.`\n    super(response, body, message)\n  }\n}\n\n\nexport {\n  getError\n}","const irc = require('@inrupt/solid-react-components');\n// Use the Read, Write, Append and Control modes from solid-react-components\nconst MODES = irc.AccessControlList.MODES\nMODES.COMMENT = \"Comment\"\nexport { MODES }; // MODES.READ, MODES.WRITE, MODES.APPEND, MODES.CONTROL\n\n/**\n * Create a permission-object, to pass to createACL or addToACL\n * @param object[]: modes A list of modes,\n * @param string[] | null: people A list of webID's, null for everyone\n * @returns object\n */\nconst createPermission = (modes, people = null) => {\n  return {\n    agents: people,\n    modes: modes\n  };\n}\n\n/**\n * Create an ACL file for a document\n *    default permissions for creator: Read, Write, Control\n * @param docURI The document URI on which the permissions apply\n * @param permissions Permissions, like created by `createPermission`\n */\nconst createACL = async (webId, docURI, permissions) => {\n  const ACL = new irc.AccessControlList(\n    webId,\n    docURI,\n    docURI + '.acl'\n  );\n  console.log(permissions)\n  await ACL.createACL(permissions);\n}\n\n/**\n * Dalete the ACL file for a document, then make a new one\n *    default permissions for creator: Read, Write, Control\n * @param string: docURI The document URI on which the permissions apply\n * @param object[]: permissions Permissions, like created by `createPermission`\n */\nconst reCreateACL = async (webId, docURI, permissions) => {\n  const ACL = new irc.AccessControlList(\n    webId,\n    docURI,\n    docURI + '.acl'\n  );\n  // If the file inherits it's ACL from a parent container, this will generate a 404\n  // Aside from the error in the console, this is wanted behaviour though\n  await ACL.deleteACL();\n  await ACL.createACL(permissions);\n}\n\n/**\n * Adds given permissions to the ACL file for a document\n * @param string: docURI The document URI on which the permissions apply\n * @param object[]: permissions Permissions, like created by `createPermission`\n */\nconst addToACL = async (webId, docURI, permissions) => {\n  const ACL = new irc.AccessControlList(\n    webId,\n    docURI,\n    docURI + '.acl'\n  );\n  await ACL.assignPermissions(permissions);\n}\n\n/**\n * \n * @param {string} docURI \n */\nconst deleteACL = async (webId, docURI) => {\n  const ACL = new irc.AccessControlList(\n    webId,\n    docURI,\n    docURI + '.acl'\n  );\n  await ACL.deleteACL();\n}\n\n/**\n * \n * @param {string} docURI \n */\nconst getPermissions = async (webId, docURI) => {\n  const ACL = new irc.AccessControlList(\n    webId,\n    docURI,\n    docURI + '.acl'\n  );\n  return ACL.getPermissions();\n}\n\n\nexport { createPermission, createACL, reCreateACL, addToACL, deleteACL, getPermissions }","import { getVal, getValArray } from \"../../singletons/QueryEngine\";\nimport ns from \"../NameSpaces\";\nimport { putFile, patchFile, postFile } from \"../FileUtil\";\nimport { getError } from \"../../Errors/errors\";\nimport { createACL, createPermission, MODES } from \"../PermissionManager\";\nimport { getBaseIRI } from \"../Util\";\nimport { getResourceAsStore } from \"@dexagod/rdf-retrieval\";\n/**\n * Check profile for a publications collection\n * @param {string} webId \n */\nconst getDocumentsCollection = async (webId) => await getVal(webId, ns.ex('publications'));\n\n// const getCollectionMemberSeeAlso\n\n/**\n * Get the documents metadata from the publications collection\n * @param {string} webId \n */\nconst getPublicationIds = async (webId) => {\n  const publications = await getValArray(webId, ns.ex('publications'), ns.hydra('member'));\n  // const documentMetadataFileId = await getValArray(webId, ns.ex('publications'), ns.hydra('member'), ns.rdfs('isDefinedBy'));\n  const documentsMetadata = []\n  for (const [index, documentId] of publications.entries()) {\n    documentsMetadata.push(documentId)\n  }\n  return documentsMetadata\n}\n\n/**\n * Get the documents metadata from the publications collection\n * @param {string} webId \n */\nconst getPublications = async (webId) => {\n  const publicationIds = await getPublicationIds(webId);\n  const publications = []\n  for (let publicationId of publicationIds) {\n    publications.push(new Promise((resolve, reject) => {\n      getPublicationData(publicationId).then(publicationData => {\n        publicationData.name = publicationData && publicationData.title && publicationData.title[0]\n        resolve(publicationData)\n      })\n    }))\n  }\n  return publications\n}\n\nconst getDocumentMetadata = async (documentId, metadataId) => {\n  console.log('testing', `${await getVal(metadataId, documentId)}`)\n  const metadata = {\n    id: metadataId,\n    type: await getVal(metadataId, ns.rdf('type')),\n    title: await getVal(metadataId, ns.ex('title')),\n    keywords: await getValArray(metadataId, ns.ex('keywords')),\n    date: await getVal(metadataId, ns.ex('date')),\n    authors: await getValArray(metadataId, ns.ex('authors')),\n    abstract: await getVal(metadataId, ns.ex('abstract')),\n    comments: await getVal(metadataId, ns.ex('comments')),\n  }\n  metadata.date = metadata.date && new Date(metadata)\n  return metadata\n}\n\nconst getPublicationData = async (id) => {\n  console.log('getting data from', id)\n  console.log('getting title', JSON.stringify(await getValArray(id, 'type')))\n  const publication = {\n    id: id,\n    type: await getValArray(id, ns.rdf('type')),\n    title: await getValArray(id, ns.ex('title')),\n    keywords: await getValArray(id, ns.ex('keywords')),\n    authors: await getValArray(id, ns.ex('authors')),\n    date: await getValArray(id, ns.ex('date')),\n    abstract: await getValArray(id, ns.ex('abstract')),\n    file: await getValArray(id, ns.ex('file')),\n    lifecycleEvents: await getValArray(id, ns.ex('lifecycleEvents')),\n  }\n  publication.date = publication.date && new Date(publication.date)\n  console.log('retrieved:', publication)\n  return publication\n}\n\n/**\n * Function to retrieve events from an LDES ldp container\n * @param {string} id The LDES directory id\n */\nconst retrieveLDESEventIds = async (id) => {\n  const store = await getResourceAsStore(id)\n  const assertion = await store.getQuads(id, ns.rdf('type'), ns.ldes('EventStream'))\n  if (!assertion || !assertion.length) return [];\n\n  // Discover all the member events\n  const eventIds = (await store.getQuads(id, ns.ldp('Resource'), null)).map(q => q.object.id)\n  return eventIds\n}\n\nconst retrieveEvent = async (id) => {\n  const event = {\n    id: id,\n    type: await getValArray(id, ns.rdf('type')),\n    created_at: await getValArray(id, ns.ex('created_at')),\n    token: await getValArray(id, ns.ex('token')),\n  }\n  event.created_at = event.created_at && new Date(event.created_at)\n  return event\n}\n\nconst retrieveLDESEvents = async (id) => {\n  const eventIds = await retrieveLDESEventIds(id)\n  const events = []\n  for (let eventId of eventIds) {\n    events.push(retrieveEvent(eventId))\n  }\n  return Promise.all(events)\n}\n\n\n\n/**\n * Create publication document in turtle format\n * @param {*} documentMetadata \n * @param {*} documentId \n */\nconst createPublicationTTLResource = (documentMetadata, documentURI, eventStreamURI) => {\n  return `\n  @prefix : <#>.\n  @prefix ex: <${ns.ex('')}> .\n  @prefix xsd: <${ns.xsd('')}> .\n  :artefact a ex:Publication ;\n    ex:title \"${documentMetadata.title}\" ;\n    ex:keywords \"${documentMetadata.keywords.join('\", \"')}\" ;\n    ex:date \"${documentMetadata.date}\"^^xsd:date ;\n    ex:authors <${documentMetadata.authors.join('>, <')}> ;\n    ex:abstract \"${documentMetadata.abstract}\" ;\n    ex:file <${documentURI}> ;\n    ex:lifecycleEvents <${eventStreamURI}> .\n  `\n}\n\nconst createEventStreamMetadataFile = () => {\n  return `\n@prefix : <#>.\n@prefix folder: <>.\n@prefix ldes: <https://w3id.org/ldes#>.\nfolder: a ldes:EventStream.\n  `\n}\n\nconst createCollectionPatchBody = async (webId, publicationResourceId) => {\n  const collectionId = await getDocumentsCollection(webId)\n  return `INSERT { \n    <${collectionId}> <${ns.hydra('member')}> <${publicationResourceId}>.\n  }`\n}\n\n/**\n * \n * @param {File} file Publication Document\n * @param {string} location Location to publish the publication document root\n * @returns {{rootURI: string, publicationURI: string, publicationDocumentURI: string, eventStreamFolderURI: string}}\n */\nconst getPublicationURIs = (file, location, publicationExtension = '.ttl') => {\n  if (!location) return;\n  if (!location.endsWith(\"/\")) location = location + \"/\";\n  const fileNameBaseFolder = file.name.split('.')[0] + '/'\n  const rootURI = location + fileNameBaseFolder\n  const publicationDocumentURI = rootURI+file.name\n  const publicationURI = createPublicationIdentifier(publicationDocumentURI)\n  const eventStreamFolderURI = rootURI+'eventStream/'\n  const artefactURI = publicationURI+'#artefact'\n  return { rootURI, publicationURI, publicationDocumentURI, eventStreamFolderURI, artefactURI };\n}\n\nconst createPublicationIdentifier = (documentId, extention) => {\n  const split = documentId.split('.');\n  return split.slice(0, split.length-1).join('.') + '_publication.' + (extention || 'ttl')\n}\n\nconst checkAndThrowErrors = (response, URI, requestBody) => {\n  if (response.code >= 400 && response.code < 500) throw new getError(URI, response, requestBody)\n}\n\n\n/**\n * \n    submission.authors = submission.authors.map(a => a.webId).filter(a => !!a)\n    submission.keywords = submission.authors.map(k => k.val).filter(k => !!k)\n    submission.file = submission.file[0]\n * @param {{title: string, date: Date, abstract: string, description?: string, authors: string[], keywords: string[], file: any, location: string}} submission \n * @param {string} webId The user WebId\n */\nconst uploadPublication = async (submission, webId) => {\n  const documentMetadata = submission\n  const location = submission.location\n  \n  // rootURI, publicationURI, publicationDocumentURI, eventStreamFolderURI\n  const publicationIds = getPublicationURIs(documentMetadata.file, location)\n  \n  // Uploading submission document (the publication document in pdf / http format)\n  const documentPut = putFile(publicationIds.publicationDocumentURI, documentMetadata.file)\n  checkAndThrowErrors(documentPut, publicationIds.publicationDocumentURI, documentMetadata.file.name)\n  \n  // Uploading the publication file, containing the required metadata, and referencing the uploaded file\n  const publicationRDFResource = createPublicationTTLResource(documentMetadata, publicationIds.publicationDocumentURI, publicationIds.eventStreamFolderURI)\n  const publicationPut = await putFile(publicationIds.publicationURI, publicationRDFResource, {\"Content-Type\": 'text/turtle'})\n  checkAndThrowErrors(publicationPut, publicationIds.publicationURI, publicationRDFResource)\n\n  // create event stream metadata body\n  const FolderMetadataBody = await createEventStreamMetadataFile()\n  // set LDES folder metadata\n  // this indirectly also creates the event stream folder\n  const eventStreamMetadataPut = await putFile(publicationIds.eventStreamFolderURI+'.meta', FolderMetadataBody, {\"Content-Type\": 'text/turtle'})\n  checkAndThrowErrors(eventStreamMetadataPut, publicationIds.eventStreamFolderURI+'.meta', FolderMetadataBody)\n  \n  // Update collection\n  const patchBody = await createCollectionPatchBody(webId, publicationIds.artefactURI)\n  const patch = await patchFile(webId, patchBody)\n  checkAndThrowErrors(patch, webId, patchBody)\n\n  \n  // Set public read permissions for the publication\n  await createACL(webId, publicationIds.rootURI,\n    [createPermission([MODES.READ], null)]\n  );\n  // Enable write permissions for the even stream\n  await createACL(webId, publicationIds.eventStreamFolderURI,\n    [createPermission([MODES.READ, MODES.WRITE], null)]\n  );\n\n  // Post a created lifecycle event to the eventstream\n  const eventpostbody = await createLifecycleEvent(webId, 'Create')\n  const eventpost = await postFile(publicationIds.eventStreamFolderURI, eventpostbody)\n  checkAndThrowErrors(eventpost, publicationIds.eventStreamFolderURI, eventpostbody)\n  \n  return publicationIds.publicationURI\n}\n\nconst getDocumentMetadataId = async (webId, documentId) => {\n  const documentsAndMetadata = await getPublicationIds(webId);\n  const documentIds = documentsAndMetadata.filter(e => e.id === documentId)\n  return documentIds[0] && documentIds[0].metadataId\n}\n\n\n\nconst createLifecycleEvent = (webId, eventType) => {\n  return `\n  @prefix ex: <${ns.ex('')}> .\n  @prefix xsd: <${ns.xsd('')}> .\n  <> a ex:${eventType} ;\n   ex:created_at \"${new Date().toISOString()}\"^^xsd:date ;\n   ex:creator <${webId}> .\n  `\n}\n\nconst createComment = (commentData) => {\n  return `\n    @prefix sioc: <${ns.sioc('')}> .\n    @prefix xsd: <${ns.xsd('')}> .\n    <> a sioc:Post ;\n     sioc:reply_of <${commentData.reply_of}> ;\n     sioc:created_at \"${commentData.created_at}\"^^xsd:date ;\n     sioc:has_creator \"${commentData.has_creator}\" ;\n     sioc:content <${commentData.content}> ;\n     sioc:note \"${commentData.node}\" .\n  `\n}\n\nconst createCommentNotifications = (webId, commentId, commentData) => {\n  return `\n    @prefix as: <${ns.as('')}> .\n    @prefix sioc: <${ns.sioc('')}> .\n    <> a as:Announce ;\n      as:actor <${webId}> ;\n      as:object [ \n        a as:Create ;\n        as:actor <${webId}>  ;\n        as:object <${commentId}> ;\n        as:target <${commentData.reply_of}> ;\n      ] ;\n      as:summary \"${webId} created a new comment on ${commentData.reply_of}.\" .\n    <${commentId}> a sioc:Post ;\n      sioc:reply_of <${commentData.reply_of}> .\n  `\n}\n\nconst createPublicationUploadNotification = (webId, documentId, metadataId) => {\n  return `\n    @prefix as: <${ns.as('')}> .\n    @prefix rdfs: <${ns.rdfs('')}> .\n    @prefix ex: <${ns.ex('')}> .\n    <> a as:Announce ;\n      as:actor <${webId}> ;\n      as:object [ \n        a as:Create ;\n        as:actor <${webId}>  ;\n        as:object <${documentId}> ;\n      ] ;\n      as:summary \"${webId} uploaded a new publication.\" .\n    <${documentId}> a ex:Publication ;\n      rdfs:isDefinedBy <${metadataId}> .\n  `\n}\n\n\nconst createAndPostComment = async (webId, commentData, metadataId) => {\n  if (!commentData.documentId || !commentData.has_creator) {\n    return false;\n  }\n  \n  // Create comment body\n  const commentbody = createComment(commentData)\n  // Create comment file\n  const postresponse = await postFile(commentData.location, commentbody)\n  checkAndThrowErrors(postresponse, commentData.location, commentbody)\n  const relativeCommentLocation = Object.fromEntries(postresponse.headers).location\n  const absoluteCommentLocation = getBaseIRI(commentData.has_creator) + relativeCommentLocation.slice(1) // TODO:: is this the best way? webId base IRI , remove starting / for second part\n  console.log('commentLocation', absoluteCommentLocation)\n\n  await createACL(webId, absoluteCommentLocation,\n    [createPermission([MODES.READ], null)] // make comment publicly readable\n  );\n\n  // // // Update metadata information with link to comment\n  const patchBody = `INSERT { <${commentData.reply_of}> <${ns.ex('comments')}> <${absoluteCommentLocation}> }` \n  const response = await patchFile(metadataId, patchBody)\n  checkAndThrowErrors(response, metadataId, patchBody)\n\n  // // send notifications of comment to all contacts\n  // const commentNotification = createCommentNotifications(webId, absoluteCommentLocation, commentData)\n  // const profile = await fetchProfile(webId) || null\n  // let contacts = (profile && profile.contacts) || [];\n  // const agent = getInboxAgent(webId) \n  // agent.sendNotification({notification: commentNotification, to: contacts})\n\n  return true\n}\n   \n\n\nexport {checkAndThrowErrors, getDocumentsCollection, getPublicationIds, uploadPublication, getDocumentMetadata, createAndPostComment, getDocumentMetadataId, getPublicationData, retrieveLDESEventIds, retrieveEvent, retrieveLDESEvents, getPublications}\n\n\n\n","import React, { useState } from 'react'\nimport useNotifications from '../hooks/useNotifications'\nimport CloseIcon from '@material-ui/icons/Close';\n\n// import { Col, Row, Grid } from 'react-flexbox-grid'\nimport { Button, Row, Col } from 'react-bootstrap'\nimport { Value } from '@solid/react';\n\nimport ns from \"../util/NameSpaces\"\n\nimport { availableViews, getContractData, routeViewWithParams } from '../util/Util'\nimport { deleteFile } from '../util/FileUtil';\nimport { IconButton } from '@material-ui/core';\nimport { useHistory } from 'react-router-dom';\nimport { checkAndThrowErrors } from '../util/MellonUtils/documents';\n\nconst NotificationsViewerComponent = (props) => {\n\n  const NotificationCard = (props) => {\n    const history = useHistory();\n    const notification = props.notification\n    const notificationObject = props.notification.jsonld[0]\n    \n    let notificationProperties = []\n    for (const property in notificationObject) {\n      notificationProperties.push(property)\n    }\n\n    console.log('notificationProperties', notificationProperties)\n  \n    \n    // const viewPublication = (notification) => viewDocument(notification.object.object.id);\n    // const viewComment = (notification) => viewDocument(notification.object.target.id);\n    // const viewDocument = (documentId) => history.push(routeViewWithParams(availableViews.documents, {documentId}))\n  \n    // const deleteNotification = async (notificationId) => deleteFile(notificationId).then(deleted => checkAndThrowErrors(deleted, notificationId, null))\n  \n    // console.log('NOTIFICATION', notification)\n    // // TODO;; this will fail if you have no view access to the contract\n    // function getButton() {\n    //   switch (notification.type) {\n    //     case ns.as('Announce'):\n    //       if (notification.object && notification.object.type === ns.as('Create')) {\n    //         if (notification.object.object && notification.object.object.id && notification.object.object.type === ns.ex('Publication')) {\n    //           return (<Button className={'centeraligntext'} onClick={() => viewPublication(notification)}>View Publication</Button>)\n    //         }\n    //         if (notification.object.object && notification.object.object.id && notification.object.object.type === ns.sioc('Post')) {\n    //           return (<Button className={'centeraligntext'} onClick={() => viewComment(notification)}>View Comment</Button>)\n    //         }\n    //       }\n    //       return (<div />)\n    //     default:\n    //       return (<div />)\n    //   }\n    // }\n  \n    return (\n      <div className={`NotificationCard`}>\n        <Row className='propertyview' key={notification.id}>\n          {notificationProperties.map(prop => \n            <Row>\n              <Col md={4}><label className='leftaligntext'>{prop}</label></Col>\n              <Col md={7}><label>{JSON.stringify(notificationObject[prop])}</label></Col>\n            </Row>\n          )}\n          {/* <Col md={1}><label className='leftaligntext'>{notification.type && notification.type.split('#')[1]}</label></Col> */}\n          {/* <Col md={2}><label className='leftaligntext'><a href={notification.actor.id}><Value src={`[${notification.actor.id}].name`}/></a></label></Col> */}\n          {/* <Col md={2}><label className='leftaligntext'>{notification.metadata.modified && notification.metadata.modified.toLocaleString()}</label></Col> */}\n          {/* <Col md={4}><label className='leftaligntext'>{notification.summary}</label></Col> */}\n          {/* <Col md={2}>{getButton()}</Col> */}\n          {/* <Col md={1}><IconButton className={`centeraligntext`} onClick={() => props.deleteNotification(notification.metadata.id)}><CloseIcon style={{color: 'red'}}/></IconButton></Col>  */}\n        </Row>\n      </div>\n    )\n  }\n  \n  const notifications = useNotifications(props.webId)\n  // Sort on notification modified (= created normally) in reverse order to get newest first\n\n  console.log('NOTIFICATIONS', notifications)\n  const sortednotifications = notifications.sort( (a, b) => new Date(b.date) - new Date(a.date))\n\n  // async function deleteNotification(notificationId) {\n  //   deleteFile(notificationId);\n  //   setDeleted(deleted.concat(notificationId))\n  // }\n\n\n  return (\n    <div id=\"notificationsviewercomponent\" className='container'>\n      <h4> Notifications </h4>\n      <br />\n      <Row className='propertyview pageheader' key={'header'}>\n        <Col md={1}><label className=\"leftaligntext\"><b>Type</b></label></Col>\n        <Col md={2}><label className=\"leftaligntext\">Sender</label></Col>\n        <Col md={2}><label className=\"leftaligntext\">Time received</label></Col>\n        <Col md={4}><label className=\"leftaligntext\">Summary</label></Col>\n        <Col md={2}><label className=\"centeraligntext\">Action</label></Col>\n      </Row>\n      {sortednotifications.map((notification, index) => {\n        return ( <NotificationCard notification={notification} {...props} key={index} /> )\n      })}\n      \n    </div>\n  )\n}\nexport default NotificationsViewerComponent\n\n// const NotificationCard = (props) => {\n//   const history = useHistory();\n//   const notification = props.notification\n\n  \n//   const viewPublication = (notification) => viewDocument(notification.object.object.id);\n//   const viewComment = (notification) => viewDocument(notification.object.target.id);\n//   const viewDocument = (documentId) => history.push(routeViewWithParams(availableViews.documents, {documentId}))\n\n//   const deleteNotification = async (notificationId) => deleteFile(notificationId).then(deleted => checkAndThrowErrors(deleted, notificationId, null))\n\n//   console.log('NOTIFICATION', notification)\n//   // TODO;; this will fail if you have no view access to the contract\n//   function getButton() {\n//     switch (notification.type) {\n//       case ns.as('Announce'):\n//         if (notification.object && notification.object.type === ns.as('Create')) {\n//           if (notification.object.object && notification.object.object.id && notification.object.object.type === ns.ex('Publication')) {\n//             return (<Button className={'centeraligntext'} onClick={() => viewPublication(notification)}>View Publication</Button>)\n//           }\n//           if (notification.object.object && notification.object.object.id && notification.object.object.type === ns.sioc('Post')) {\n//             return (<Button className={'centeraligntext'} onClick={() => viewComment(notification)}>View Comment</Button>)\n//           }\n//         }\n//         return (<div />)\n//       default:\n//         return (<div />)\n//     }\n//   }\n\n//   return (\n//     <div className={`NotificationCard`}>\n//       <Row className='propertyview' key={notification.metadata.id}>\n//         <Col md={1}><label className='leftaligntext'>{notification.type && notification.type.split('#')[1]}</label></Col>\n//         <Col md={2}><label className='leftaligntext'><a href={notification.actor.id}><Value src={`[${notification.actor.id}].name`}/></a></label></Col>\n//         <Col md={2}><label className='leftaligntext'>{notification.metadata.modified && notification.metadata.modified.toLocaleString()}</label></Col>\n//         <Col md={4}><label className='leftaligntext'>{notification.summary}</label></Col>\n//         <Col md={2}>{getButton()}</Col>\n//         <Col md={1}><IconButton className={`centeraligntext`} onClick={() => props.deleteNotification(notification.metadata.id)}><CloseIcon style={{color: 'red'}}/></IconButton></Col>\n//       </Row>\n//     </div>\n//   )\n// }","import ns from \"../../util/NameSpaces\"\nimport { getVal, getValArray } from '../../singletons/QueryEngine'\nimport { patchFile } from \"../FileUtil\";\nimport { getError } from \"../../Errors/errors\";\nimport { getDocumentsCollection, checkAndThrowErrors } from \"./documents\";\n\n/**\n * \n * @param {string} id - The profile id\n */\nconst fetchProfile = async (id) => {\n  console.log('fetching profile')\n  id = await id;\n  return {\n    id: id,\n    name: await getVal(id, ns.foaf('name')), \n    bdate: await getVal(id, ns.dbo('birthDate')), \n    location: await getVal(id, ns.dbo('location')),\n    contacts: await getValArray(id, ns.foaf('knows'))\n  }\n}\n\nconst followProfile = async (webId, profileWebId) => {\n  const patchBody = `INSERT { <${webId}> <${ns.foaf('knows')}> <${profileWebId}> }`\n  const response = await patchFile(webId, patchBody)\n  checkAndThrowErrors(response, webId, patchBody)\n  return response\n}\n\nconst unfollowProfile = async (webId, profileWebId) => {\n  const patchBody = `DELETE { <${webId}> <${ns.foaf('knows')}> <${profileWebId}> }`\n  const response = await patchFile(webId, patchBody)\n  checkAndThrowErrors(response, webId, patchBody)\n  return response\n}\n\n/**\n * Get the publication collection id\n * @param {string} webId \n * @returns string\n */\nconst getCollectionId = (webId) => webId && webId.split('#')[0]+'#publications'\n\n/**\n * Initialize profile with collection of publications (if collection is not yet present)\n * @param {string} webId \n * @returns boolean\n */\nconst createCollection = async (webId) => {\n  if (await getDocumentsCollection()) return true\n\n  const collectionId = getCollectionId(webId)\n  const patchBody = `INSERT { \n    <${webId}> <${ns.ex('publications')}> <${collectionId}> .\n    <${collectionId}> <${ns.rdf('type')}> <${ns.hydra('Collection')}> .\n    <${collectionId}> <${ns.dct('subject')}> <${ns.ex('Publication')}> .\n    <${collectionId}> <${ns.dct('description')}> \"${'Collection of publications'}\" .\n  }`\n  const response = await patchFile(webId, patchBody)\n  checkAndThrowErrors(response, webId, patchBody)\n  return true;\n}\n\n\nexport {\n  fetchProfile, followProfile, unfollowProfile, createCollection\n}","import { useState, useEffect } from 'react';\nimport { useLiveUpdate, } from '@solid/react';\nimport { clearCache } from '../singletons/QueryEngine';\nimport { fetchProfile } from '../util/MellonUtils/profile'\n\nconst useProfile = function(webId) {\n  const [profile, setProfile] = useState(null);\n  const liveUpdate = useLiveUpdate(webId)\n\n  useEffect(() => {\n    let mounted = true\n    const getProfile = async () => {\n      if(!webId) return\n      await clearCache(webId)\n      const profile = await fetchProfile(webId)\n      if (mounted) {\n        if(profile) {\n          profile.webId = webId\n          setProfile(profile)\n        } else {\n          setProfile(null)\n        }\n      } \n    }\n    getProfile();\n    return () => mounted = false\n  }, [webId, liveUpdate])\n  return profile\n}\n\nexport default useProfile","import React, { useEffect, useState } from 'react'\nimport ReactLoading from 'react-loading';\nimport '../../css/VCardComponent.css'\n\n\nimport { Button, Row, Col } from 'react-bootstrap'\n\n\nimport useProfile from '../../hooks/useProfile'\nimport { availableViews, formatDate } from '../../util/Util';\nimport ns from '../../util/NameSpaces';\nimport withProfile from '../../HOC/withProfile';\n\nimport { useLiveUpdate } from '@solid/react';\nconst { default: data } = require('@solid/query-ldflex');\n\nconst UNKNOWNVALUE = 'Value not set'\n\nconst ProfileViewerComponent = (props) => {\n  const webId = props.selectedWebId || props.webId\n  const profile = useProfile(webId)\n  console.log('profile', profile)\n\n  if (! profile){\n    return (\n      <div id=\"profileviewercomponent\" className='container'>\n        <h4> Profile </h4>\n        <br />\n        <ReactLoading type={\"cubes\"}/>\n      </div>\n    )\n  } \n\n  return (\n    <div id=\"profileviewercomponent\" className='container'>\n      <h4> Profile </h4>\n      <br />\n      {Object.keys(profileProps).map(property => {\n        const value = profile[property] && (property === 'bdate' ? formatDate(profile[property]) : profile[property])\n        return (\n          <Row className='propertyview ' key={property}>\n            <Col md={3}><label className=\"leftaligntext\"><b>{profileProps[property]}</b></label></Col>\n            <Col md={9}><label className=\"leftaligntext\">{value || UNKNOWNVALUE}</label></Col>\n          </Row>  \n        )\n      })}\n      <br />\n      <br />\n      <Row>\n        <Col md={2}><Button onClick={() => {navigator.clipboard.writeText(webId)}}>copy webId</Button></Col>\n        <Col md={3}></Col>\n        { webId && webId === props.webId && <Col md={2}><Button onClick={() => props.setview(availableViews.profileeditor)}>Edit</Button></Col> }\n      </Row>\n      \n      \n    </div>\n  )\n}\n\nconst profileProps = {\n  name: \"Name\",\n  bdate: \"BirthDate\",\n  location: \"Country\",\n  // cstatus: \"Civil Status\",\n}\n\nexport default ProfileViewerComponent","import { DataFactory, Writer, Quad } from \"n3\";\nimport ns from \"../util/NameSpaces\"\nimport * as f from \"@dexagod/rdf-retrieval\"\n\nconst { namedNode, literal, quad, variable } = DataFactory;\n\nexport async function createDeleteInsertProfileDataQuery(webId, oldprofile, newprofile) {\n  const deleteClause = []\n  // const insertClause = []\n  \n  const insertClause = [\n    quad(namedNode(webId), namedNode(ns.foaf('name')), literal(newprofile.name)),\n    quad(namedNode(webId), namedNode(ns.dbo('birthDate')), literal(newprofile.bdate, namedNode(ns.xsd('date')))),\n    quad(namedNode(webId), namedNode(ns.dbo('location')), literal(newprofile.location)),\n    // quad(namedNode(webId), namedNode(ns.demo('civilstatus')), literal(newprofile.cstatus)),\n  ]\n\n  if (oldprofile.name) {\n    deleteClause.push(quad(namedNode(webId), namedNode(ns.foaf('name')), literal(oldprofile.name)))\n  } if (oldprofile.bdate) {\n    deleteClause.push(quad(namedNode(webId), namedNode(ns.dbo('birthDate')), literal(oldprofile.bdate, namedNode(ns.xsd('date')))))\n  } if (oldprofile.location) {\n    deleteClause.push(quad(namedNode(webId), namedNode(ns.dbo('location')), literal(oldprofile.location)))\n  // } if (oldprofile.cstatus) {\n  //   deleteClause.push(quad(namedNode(webId), namedNode(ns.demo('civilstatus')), literal(oldprofile.cstatus)))\n  }\n\n  const deleteClauseString = deleteClause.length ? `DELETE { ${await f.quadArrayToString(deleteClause, \"text/turtle\")} }` : ''\n  const insertClauseString = insertClause.length ? `INSERT { ${await  f.quadArrayToString(insertClause, \"text/turtle\")} }` : ''\n  const whereClauseString = deleteClause.length ? `WHERE { ${await  f.quadArrayToString(deleteClause, \"text/turtle\")} }` : ''\n\n\n  return(`\n    ${deleteClauseString}\n    ${insertClauseString}\n    ${whereClauseString}\n  `)\n}","import React, {useEffect} from 'react'\nimport ReactLoading from 'react-loading';\nimport '../css/VCardComponent.css'\n\nimport { useForm, Controller } from 'react-hook-form'\nimport { patchFile } from '../util/FileUtil'\nimport { createDeleteInsertProfileDataQuery } from '../util/QueryUtil'\nimport { Select, MenuItem } from '@material-ui/core'\nimport { Button, Row, Col } from 'react-bootstrap'\n\nimport useProfile from '../hooks/useProfile'\nimport { availableViews } from '../util/Util';\n\n\nconst ProfileEditorComponent = (props) => {\n\n  const profile = useProfile(props.webId)\n\n  const { register, handleSubmit, control, reset } = useForm({ defaultValues: {} })\n\n  const onSubmit = async newprofile => {\n    patchFile(props.webId, await createDeleteInsertProfileDataQuery(props.webId, profile, newprofile))\n    props.setview(availableViews.profile)\n  }\n\n  useEffect(() => {\n    reset(profile)\n  }, [profile])\n\n  if (! profile){\n    return (\n      <div id=\"ProfileEditorComponent\" className='container'>\n        <h4> Profile </h4>\n        <br />\n        <ReactLoading type={\"cubes\"}/>\n      </div>\n    )\n  } \n\n  const properties = [\n    {label: 'Name',       name: 'name',       type: 'text',}, \n    {label: 'BirthDate',  name: 'bdate',      type: 'date',},\n    {label: 'Country',    name: 'location',   type: 'text',},\n  ]\n\n  return (\n    <div id=\"ProfileEditorComponent\" className='container'>\n      <h4> Profile </h4>\n      <br />\n      <form onSubmit={handleSubmit(onSubmit)}>\n        {properties.map(prop => {\n          return(\n            <Row className='propertyview ' key={prop.name}>\n              <Col md={3}><label className=\"leftaligntext\"><b>{prop.label}</b></label></Col>\n              {prop.controller\n              ? <Col md={1}>{prop.controller}</Col>\n              : <Col md={9}><input type={prop.type || 'text'} className='leftaligntext inputfield' name={prop.name} ref={register({ required: true })} /></Col> \n              }\n            </Row>  \n          )\n        })}\n        <br/>\n        <br/>\n        <Button type=\"submit\">Submit</Button>\n      </form>\n    </div>\n  )\n}\n\nexport default ProfileEditorComponent\n\n// <h2>All friends</h2>\n// <List src=\"[https://ruben.verborgh.org/profile/#me].friends.firstName\"/>\n\n// @prefix dbo: <http://dbpedia.org/ontology/>. dbo:birthDate, dbo:birthPlace","import React from 'react'\n\nconst HelpComponent = (props) => {\n  return (\n    <div id=\"HelpComponent\" className='container leftaligntext'>\n      TODO\n    </div>\n  )\n}\n\nexport default HelpComponent\n\n\n\n\n/*\n<h4 className='container centeraligntext'>How to get married with SOLID in 5 simple steps</h4>\n\n      <Row>\n        <Col md={1}>{availableViews.login.icon}</Col>\n        <Col md={11}><h4>Preliminaries</h4></Col>\n      </Row>\n      <Row>\n      \n        <Col md={1}></Col>\n        <Col md={11}>\n          <p>Before starting this demonstration for SOLID, you are expected to created a SOLID pod.</p>\n          <p>In case you do not do not yet have a SOLID pod available, you can create a pod on <a href={'https://solid.community/register'}>solid community</a>.</p>\n          <p>(or using login button - choose provider - register account. But this should be explained with pictures)</p>\n        </Col>\n      </Row>\n      <br />\n        \n      <Row>\n        <Col md={1}>{availableViews.profile.icon}</Col>\n        <Col md={11}><h4>Step 1 - Complete user profile</h4></Col>\n      </Row>\n      <Row>\n        <Col md={1}></Col>\n        <Col md={11}>\n          <p>The first step of this demonstration is to fill out your profile information.</p>\n          <p>This ensures that subsequent steps in the demonstration can retrieve some information from your pod to show in the forms.</p>\n          <p>You can find (some of) your profile information in the profile tab on the left.</p>\n          <p>In this tab, you can edit your profile information by clicking the <Button>Edit</Button> button.</p>\n          <p>In the edit screen, you can fill in your profile information in the fields, and submit the using the <Button type=\"submit\">Submit</Button> button.</p>\n          <p>All fields are mandatory!</p>\n        </Col>\n      </Row>\n      <br />\n\n      <Row>\n        <Col md={1}>{availableViews.requests.icon}</Col>\n        <Col md={11}><h4>Step 2 - Planning a Wedding</h4></Col>\n      </Row>\n      <Row>\n        <Col md={1}></Col>\n        <Col md={11}>\n          <p>Now that your profile information is filled in, you can start planning your wedding.</p>\n          <p>To initiate the marriage procedure, go to the <b>Procedures</b> tab.</p>\n          <p>Here, the procedure can be initiated by clicking <Button>Initiate procedure</Button> for the Marriage certificate type.</p>\n          <p>Now, you will find your information already filled out as one of the spouses.</p>\n          <p>A marriage requires two spouses to be given, as well as one or more witnesses.</p>\n          <p>If a valid webId is entered, the associated profile will be shown automatically.</p>\n          <p>In case this profile is incomplete, an error message will be shown. Please choose a different webId, or wait for the person to complete their profile.</p>\n          <p>If all necessary information is filled in, the proposal is ready to be submitted.</p>\n          <p>You can use the default storage location to store the created marriage proposal on your pod, or select a custom location (please make sure the selected location is valid, and read permissions are public. If this is not the case, the people you invite will not be able to see the marriage proposal).</p>\n          <p>Now, you can submit the marriage proposal using <Button>Submit</Button></p>\n        </Col>\n      </Row>\n      <br />\n\n      <Row>\n        <Col md={1}>{availableViews.running.icon}</Col>\n        <Col md={11}><h4>Step 3 - Confirming requests</h4></Col>\n      </Row>\n      <Row>\n        <Col md={1}></Col>\n        <Col md={11}>\n          <p>On creation of a marriage proposal, all parties (spouses and witnesses) are notified of the created proposal.</p>\n          <p>These notifications can be found by clicking the notification icon \n          <IconButton aria-label={'notifications'} color=\"inherit\">\n            <Badge badgeContent={1} color=\"secondary\">\n              {availableViews.notifications.icon}\n            </Badge>\n          </IconButton>\n          at the top of your screen.</p>\n          <p>Now, you can see the marriage proposal, and all people involved in the proposal.</p>\n          <p>In this form, you will see two action buttons next to your name: <button type=\"button\" className=\"marriageview_accept__3V0c_ centeraligntext btn btn-primary\" style={{width: '120px'}}> Accept </button> and <button type=\"button\" className=\"marriageview_refuse__2lqar centeraligntext btn btn-primary\" style={{width: '120px'}}> Refuse </button>.</p>\n          <p>With these, you can accept or refuse the invitation.</p>\n          <p>For the creator of a proposal, a button is available to resend an invitation. This will trigger another notification to be sent to the person.</p>\n          <p>When everybody has accepted the proposal, a button <button type=\"button\" className=\"marriageview_accept__3V0c_ valuebutton btn btn-primary\" style={{width: '220px'}}> Submit Marriage Proposal </button> is available for the creator of the proposal to submit the proposal for validation.</p>\n        </Col>\n      </Row>    \n      <br />\n\n      <Row>\n        <Col md={1}>{availableViews.official.icon}</Col>\n        <Col md={11}><h4>Step 4 - Validation by an official</h4></Col>\n      </Row>\n      <Row>\n        <Col md={1}></Col>\n        <Col md={11}>\n          <p>With the proposal submitted, it is now ready to be validated by a state official.</p>\n          <p>In this demo, you are yourself promoted to state official, congratulations!</p>\n          <p>Now that you are a state official, you can see the proposals submitted to the state pod inbox (which in this case is the inbox of your personal pod) in the official tab</p>\n          <p>In this tab, all proposal submissions that are made to the state pod (your pod in this case) are listed.</p>\n          <p>A proposal can be evaluated by clicking <Button className='centeraligntext' style={{width: '100px'}}>Evaluate</Button></p>\n          <p>In the evaluation screen, the people involved in the proposal are listed with their information and their status if they confirmed or rejected the wedding proposal.</p>\n          <p>In case all information can be retrieved, and all people have confirmed their part in the marriage, the official (you) can approve the marriage proposal with <button type=\"button\" className=\"marriageview_accept__3V0c_ valuebutton btn btn-primary\" style={{width: '160px'}}> Approve Proposal </button>, or choose to reject it with <button type=\"button\" className=\"marriageview_delete__1FaK6 valuebutton btn btn-primary\" style={{width: '160px'}}> Reject Proposal </button>.</p>\n          <p>Depending on your choice, a notification will be sent to the people involved that the marriage proposal has been approved or rejected</p>\n        </Col>\n      </Row>    \n      <br />\n\n      <Row>\n        <Col md={1}>{availableViews.certificates.icon}</Col>\n        <Col md={11}><h4>Step 5 - Retrieving the certificate</h4></Col>\n      </Row>\n      <Row>\n        <Col md={1}></Col>\n        <Col md={11}>\n          <p>In the case that your marriage proposal is accepted, you are now officially married, and you can now retrieve your marriage certificate.</p>\n          <p>This can be found in the Certificates tab.</p>\n          <p>You can view the certificate using  <button type=\"button\" className=\"btn btn-primary\" style={{width: '150px'}}>View certificate</button>.</p>\n          <p>In this view, all the information about the marriage and the certificate is listed.</p>\n          <p>A PDF version of the certificate can be retrieved using <button type=\"button\" className=\"btn btn-primary\" style={{width: '100px'}}>Get PDF</button>.</p>\n        </Col>\n      </Row>\n      <br />\n\n*/","import React from 'react';\nimport '../../css/LoginComponent.css';\n\nimport { LoginButton } from '@solid/react';\n\nfunction LoginComponent() {\n  return (\n    <div className=\"logincomponent\">\n      <div className=\"center\">\n        <LoginButton className=\"loginButton\" popup=\"https://inrupt.net/common/popup.html\">Login</LoginButton>\n      </div>\n    </div>\n  );\n}\n\nexport default LoginComponent;\n","import React from 'react';\nconst FeedComponent = (props) => {\n  const webId = props.selectedWebId || props.webId\n\n  return (\n    <div id=\"feedcomponent\" className='container'>\n      <h4> Feed </h4>\n      <br />\n      This component shows the activities for which notifications have been received based on the ActivityPub protocol.\n      The goal is for users to subscribe to services (follow certain topics such as linked data, Ugent papers, ...), \n      hosted by different organisations (Ugent, VUB, researchweb?, ...) and see the resulting feed\n    </div>\n  )\n}\n\n\nexport default FeedComponent","import useProfile from 'hooks/useProfile';\nimport React, { useState, useEffect } from 'react';\nimport { useHistory } from \"react-router-dom\";\nimport { Row, Col, Button } from 'react-bootstrap'\nimport { getPublicationData } from 'util/MellonUtils/documents';\nimport { availableViews, routeViewWithParams } from '../../util/Util';\nimport styles from '../../css/components/profilecard.module.css'\n\nconst ArtefactCard = (props) => {\n  const publicationData = props.publicationData\n\n  // prepare history to route on document info view\n  const history = useHistory();\n\n  const getStrVal = (key, value) => {\n    switch (key) {\n      case 'date':\n        return (new Date(value)).toLocaleString()\n      case 'authors':\n        return (<a href={value}><ProfileNameView webId={value}/></a>)\n      default:\n        return value\n    }\n  }\n\n  const openFile = () => publicationData.file && window.open(publicationData.file)\n\n  const getOverview = () => {\n    const route = routeViewWithParams(availableViews.documentinfo, {documentId: publicationData.id})\n    history.push(route);\n  }\n\n  const fields = props.fields || ['id', 'type', 'title', 'date', 'authors', 'keywords', 'abstract']\n  return (\n    <div id=\"artefactcard\" className={styles.container} key={\"artefactcard\"+publicationData.id}>\n      <Row>\n        <Col md={2}>\n          <Button style={{\"width\": \"100%\"}} onClick={getOverview}>Overview</Button>\n        </Col>\n        <Col md={2}>\n          <Button style={{\"width\": \"100%\"}} onClick={openFile}>Open File</Button>\n        </Col>\n        \n      </Row>\n      {publicationData && fields.map(key => \n          (Array.isArray(publicationData[key]) ? publicationData[key] : [ publicationData[key] ]).map((value, index) =>\n            <Row className={`propertyview ${styles.profilecardrow}`} key={key+value}>\n              <Col md={2}><label className='leftaligntext'><b>{index === 0 ? key : ''}</b></label></Col>\n              <Col md={10}><label className='leftaligntext'>{getStrVal(key, value)}</label></Col>\n            </Row>\n          )\n        )}\n    </div>\n  )\n}\n\nconst ProfileNameView = (props) => {\n  const userProfile = useProfile(props.webId)\n  return (<div>{userProfile ? userProfile.name || props.webId : props.webId}</div>)\n}\n\nexport default ArtefactCard\n","import React, { useState, useEffect } from 'react';\nimport \"../../css/DocumentsView.css\"\nimport { getPublicationIds, getDocumentsCollection, getPublicationData } from '../../util/MellonUtils/documents';\nimport { useHistory } from \"react-router-dom\";\nimport ArtefactCard from 'Components/Documents/ArtefactCard';\n\nconst DocumentsViewerComponent = (props) => {\n  const ownerWebId = props.selectedWebId || props.webId\n  const [foundPublications, setFoundPublications] = useState([])\n\n  useEffect(() => {\n    if(!ownerWebId) return;\n    let mounted = true;\n    const f = async () => {\n      const publications = []\n      const publicationIds = await getPublicationIds(ownerWebId)\n      for (let publicationId of publicationIds) {\n        publications.push(new Promise((resolve, reject) => {\n          getPublicationData(publicationId).then(publicationData => {\n            publicationData.name = publicationData.title\n            console.log('resolving', publicationData)\n            resolve(publicationData)\n          })\n        }))\n      }\n      return await Promise.all(publications)\n    }\n    f().then(publications => {\n      if (mounted) setFoundPublications(publications)\n    })\n    return () => mounted = false;\n  }, [ownerWebId])\n\n  console.log(\"foundPublications\", foundPublications)\n\n\n\n  return (\n    <div id=\"documentscomponent\" className='container'>\n      <h4> Publications </h4>\n      <br />\n      {foundPublications.map(publicationData => {return (\n        <ArtefactCard publicationData={publicationData} key={publicationData.id} fields={['title', 'authors', 'abstract', 'keywords']} />\n      )})}\n    </div>\n  )\n}\n\n\n\n\n\nexport default DocumentsViewerComponent\n","import React from 'react'\nimport useProfile from '../hooks/useProfile'\nimport styles from '../css/components/profilecard.module.css'\nimport { Col, Row } from 'react-bootstrap';\nimport { formatDate, availableViews } from '../util/Util';\nimport { IconButton, Tooltip } from '@material-ui/core';\nimport { Link } from 'react-router-dom';\nimport CloseIcon from '@material-ui/icons/Close';\nimport { unfollowProfile } from '../util/MellonUtils/profile';\n\nconst ProfileCardComponent = (props) => {\n  const profileWebId = props.profileWebId\n\n  const profile = useProfile(profileWebId)\n  if(!profile || !profile.name) return(<div />);\n\n  const unfollow = async() => {\n    try { \n      const result = await unfollowProfile(props.webId, profileWebId) \n    }\n    catch (e) { window.alert(e.message)}\n  }\n\n  return (\n    <div id=\"ProfileCardComponent\" className={styles.container}>\n      {profile && Object.keys(profileProps).map(property => {\n        const value = profile[property] && (property === 'bdate' ? formatDate(profile[property]) : profile[property])\n        return (\n          <Row className={`propertyview ${styles.profilecardrow}`} key={property}>\n            <Col sm={12} md={4}><label className=\"leftaligntext\"><b>{profileProps[property]}</b></label></Col>\n            <Col sm={12} md={8}>\n              <label className=\"leftaligntext\">\n                {property === 'name' ? <a href={profileWebId}>{value}</a> : <div>{value}</div>}\n              </label>\n            </Col>\n          </Row>\n        )\n      })}\n      <Row className={`propertyview ${styles.profilecardrow}`} key={'links'}>\n        {props.showButtons && [availableViews.profile, availableViews.documents, availableViews.feed].map(item =>\n          {console.log(item); return( \n          <Col sm={3} md={2} key={item.id}>\n            <Link to={{ pathname: item.target, search: `?selectedWebId=${profileWebId}`}}>\n              <Tooltip title={item.label}>\n                <IconButton aria-label={item.label}>\n                    {item.icon}\n                </IconButton>\n              </Tooltip>\n            </Link>\n          </Col>\n            )}\n          )\n        }\n        {props.showButtons && \n          <Col sm={3} md={2} key={'unfollow'}>\n            <Tooltip title={'unfollow'}>\n              <IconButton onClick={unfollow}>\n                  <CloseIcon />\n              </IconButton>\n            </Tooltip>\n          </Col>\n        }\n      </Row>\n    </div>\n  )\n}\n\nconst profileProps = {\n  name: \"Name\",\n  bdate: \"BirthDate\",\n  location: \"Country\",\n  // cstatus: \"Civil Status\",\n}\n\nexport default ProfileCardComponent\n","import React, { useState, useEffect } from 'react'\n\nimport Input from '@material-ui/core/Input';\nimport AddIcon from '@material-ui/icons/Add';\n\nimport useProfile from '../hooks/useProfile'\nimport ProfileCardComponent from './ProfileCardComponent';\nimport { Row, Col } from 'react-bootstrap';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport { IconButton, Tooltip } from '@material-ui/core';\nimport { followProfile } from '../util/MellonUtils/profile';\n\nconst ProfileCardSelectorComponent = (props) => {\n  const [webIdInput, setWebIdInput] = useState('')\n\n  const profile = useProfile(webIdInput)\n  console.log('profile', webIdInput, profile)\n\n  const webIdChangeHandler = (event) => {\n    setWebIdInput(event.target.value)\n  }\n\n  const isProfile = (profile) => profile.name\n\n  const warningStyle = {\n    color: 'red',\n  };\n\n  function getWarnings(profile) {\n    if(!profile || !isProfile(profile)) return webIdInput ? \"Please enter a valid webId\" : undefined\n  }\n\n  const warnings = getWarnings(profile)\n\n  const follow = async () => {\n    if (isProfile(profile)){\n      try { \n        const result = await followProfile(props.webId, profile.id) \n        setWebIdInput('')\n      }\n      catch (e) { window.alert(e.message)}\n    }\n  }\n\n  return (\n    <div id=\"ProfileCardSelectorComponent\">\n      <Row className='propertyview ' key={\"profileselect\"}>\n        <Col md={2}><label className=\"leftaligntext\"><b>{'Follow'}</b></label></Col>\n        <Col md={8}><Input className=\"leftaligntext\" value={webIdInput || ''} placeholder=\"webId\" name=\"location\" onChange={webIdChangeHandler}/></Col>\n        <Col md={2}><Tooltip title={'Follow webId'}><IconButton color=\"inherit\" onClick={follow}><AddIcon /></IconButton></Tooltip></Col>\n      </Row>\n      {warnings && <b style={warningStyle}>{warnings}</b>}\n      <Row className='propertyview ' key={\"profileview\"}>\n        <Col md={2}></Col>\n        <Col md={8}><ProfileCardComponent webId={props.webId} profileWebId={webIdInput} key={webIdInput}></ProfileCardComponent></Col>\n      </Row>\n    </div>\n  )\n}\n\nexport default ProfileCardSelectorComponent\n","import React from 'react'\n\nconst ProfileMissing = (props) => {\n  return (\n    <div id=\"profilemissingcomponent\" className='container'>\n      <h4> Contacts </h4>\n      <br />\n      <p>{`It seems that something went wrong while loading the profile for ${props.webId}.`}</p>\n      <p>{`Please make sure that the correct permissions have been set for this profile.`}</p>\n    </div>\n  )\n}\n\nexport default ProfileMissing","import React, { useState } from 'react';\nimport { getValArray } from '../../singletons/QueryEngine';\nimport useProfile from '../../hooks/useProfile';\nimport Grid from '@material-ui/core/Grid';\nimport ProfileCardComponent from '../ProfileCardComponent';\nimport ProfileCardSelectorComponent from '../ProfileCardSelectorComponent';\nimport ProfileMissing from '../FallBacks/ProfileMissing';\n\nconst ContactsComponent = (props) => {\n  const webId = props.selectedWebId || props.webId\n  const profile = useProfile(webId)\n  const contacts = profile ? profile.contacts : []\n  // const contacts = getValArray(webId, )\n  console.log('CONTACTS', profile)\n\n  if (!profile) return (<ProfileMissing webId={webId} />)\n  return (\n    <div id=\"contactscomponent\" className='container'>\n      <h4> Following </h4>\n      <br />\n      <ProfileCardSelectorComponent webId={webId}/>\n      <br />\n      <Grid container spacing={3}>\n        {contacts && contacts.length \n          ? contacts.map(contact => \n          <Grid item xs={12} md={6} key={contact}>\n            <ProfileCardComponent webId={props.webId} profileWebId={contact} showButtons={true} />\n          </Grid>)\n          : <p>{`There are currently no contacts for ${webId}.`}</p>\n        }\n      </Grid>\n      \n    </div>\n  )\n}\n\n\nexport default ContactsComponent","import React from 'react';\nconst ResourceMissingComponent = () => {\n\n  return (\n    <div id=\"feedcomponent\" className='container'>\n      <h4> Resource Missing </h4>\n      <br />\n    </div>\n  )\n}\n\n\nexport default ResourceMissingComponent","import React, { useState, useEffect } from 'react'\n\nimport Input from '@material-ui/core/Input';\nimport AddIcon from '@material-ui/icons/Add';\n\nimport useProfile from '../hooks/useProfile'\nimport ProfileCardComponent from './ProfileCardComponent';\nimport { Row, Col } from 'react-bootstrap';\nimport ClearIcon from '@material-ui/icons/Clear';\nimport { IconButton, Tooltip } from '@material-ui/core';\nimport { followProfile, fetchProfile } from '../util/MellonUtils/profile';\n\nconst ProfileCardErrorWrapper = (props) => {\n\n  const [profile, setprofile] = useState(null)\n\n  useEffect(() => {\n    let mounted = true;\n    const fetchAndSetProfile = async () => {\n      if (mounted) {\n        const fetched = await fetchProfile(props.webIdInput)\n        console.log('fetched', fetched)\n        if (mounted && fetched && fetched.name) setprofile(fetched)\n      }\n    }\n    let timer = setTimeout(() => fetchAndSetProfile(), 800)\n    return () => { clearTimeout(timer); mounted = false; }\n  }, [props.webIdInput])\n\n  function getWarnings(profile) {\n    if(!profile || !profile.name) return props.webIdInput ? \"Please enter a valid webId\" : undefined\n  }\n  const warnings = getWarnings(profile)\n  if(!profile) return (\n    <div id=\"ProfileCardErrorWrapper\">\n      {warnings && <b className=\"errortext\">{warnings}</b>}\n    </div>\n  )\n  return (\n    <div id=\"ProfileCardErrorWrapper\">\n      {warnings && <b className=\"errortext\">{warnings}</b>}\n      <Row className='propertyview ' key={\"profileview\"}>\n        <Col md={2}></Col>\n        <Col md={8}><ProfileCardComponent webId={props.webId} profileWebId={props.webIdInput} key={props.webIdInput} showButtons={false}></ProfileCardComponent></Col>\n      </Row>\n    </div>\n  )\n}\n\nexport default ProfileCardErrorWrapper\n","import React, { useState, useEffect } from 'react';\nimport { useForm, Controller, useFieldArray, useWatch } from 'react-hook-form'\nimport { Select, MenuItem, Grid, IconButton } from '@material-ui/core'\nimport { Button, Row, Col } from 'react-bootstrap'\nimport CloseIcon from '@material-ui/icons/Close';\nimport AddIcon from '@material-ui/icons/Add';\nimport ProfileCardComponent from '../ProfileCardComponent';\nimport useProfile from '../../hooks/useProfile';\nimport ProfileCardSelectorComponent from '../ProfileCardSelectorComponent';\nimport ProfileCardErrorWrapper from '../ProfileCardErrorWrapper';\nimport { fetchProfile, createCollection } from '../../util/MellonUtils/profile';\nimport { uploadPublication, getDocumentsCollection } from '../../util/MellonUtils/documents'\nimport { getBaseIRI, availableViews, routeViewWithParams } from '../../util/Util';\nimport { useHistory } from \"react-router-dom\";\n\nconst UploadComponent = (props) => {\n  const webId = props.selectedWebId || props.webId\n  const history = useHistory();\n  const defaultlocation = props.webId ? getBaseIRI(props.webId) + 'public/' : null\n\n  const { register, handleSubmit, control, reset, watch } = useForm({ defaultValues: {\n    file: null,\n    title: null,\n    date: new Date().toISOString().substr(0,10),\n    abstract: null,\n    location: defaultlocation\n  } })\n\n  useEffect(() => {\n    const defaultlocation = props.webId ? getBaseIRI(props.webId) + 'public/' : null\n    reset({\n      file: null,\n      title: null,\n      date: new Date().toISOString().substr(0,10),\n      abstract: null,\n      location: defaultlocation\n    });\n  }, [props.webId]);\n\n  const {\n    fields: keywordsfields,\n    append: keywordsappend,\n    remove: keywordsremove\n  } = useFieldArray({ control, name: \"keywords\" });\n  const {\n    fields: authorsfields,\n    append: authorsappend,\n    remove: authorsremove\n  } = useFieldArray({ control, name: \"authors\" });\n\n  // Set initial fields\n  if (keywordsfields.length === 0) keywordsappend({val: ''});\n  if (authorsfields.length === 0) authorsappend({webId: ''});\n\n  const onSubmit = async (submission) => {\n    // Clean up upload object\n    console.log('trying to submit', submission)\n    submission.authors = submission.authors.map(a => a.webId).filter(a => !!a)\n    submission.keywords = submission.keywords.map(k => k.val).filter(k => !!k)\n    submission.file = submission.file[0]\n    if (await validateSubmission(submission)) {\n      if (!props.webId) window.alert('There seems to be an issue with retrieving your pod information. Please refresh the page and try again.')\n      await checkAndInitializeCollection(props.webId)\n      try { \n          const documentId = await uploadPublication(submission, props.webId);\n          const route = routeViewWithParams(availableViews.documentinfo, {documentId: documentId})\n          history.push(route);\n      } catch (e) {\n        window.alert(e)\n      }\n    }\n  }\n  \n  const Profile = ({control, index}) => {\n    const value = useWatch({\n      control,\n      name: `authors[${index}].webId`\n    })\n    return (<ProfileCardErrorWrapper webIdInput={value} />)\n  }\n\n  const checkAndInitializeCollection = async(webId) => {\n    const collection = await getDocumentsCollection(webId)\n    if (!collection) {\n      await createCollection(webId)\n    }\n  }\n\n  const validateSubmission = async (submission) => {\n    if (!submission.file) {\n      window.alert('Please select a file to upload.')\n      return false;\n    }\n    if (!submission.title) {\n      window.alert('Please enter a title for your publication.')\n      return false;\n    }\n    if (!submission.date) {\n      window.alert('Please enter a valid date for your publication.')\n      return false;\n    }\n    if (!submission.authors || !submission.authors.length) {\n      window.alert('Please enter one or more valid authors for your publication.')\n      return false;\n    }\n    for (let author of submission.authors) {\n      const profile = await fetchProfile(author)\n      if (!profile || !profile.name) {\n        window.alert(`${author} does not reference a valid profile.`)\n        return false;\n      }\n    }\n    if (!submission.abstract) {\n      window.alert('Please enter the abstract of the publication.')\n      return false;\n    }\n    if (!submission.location) {\n      window.alert('Please enter a valid location to upload the publication to.')\n      return false;\n    }\n    return true;\n  }\n\n  return (\n    <div id=\"uploadcomponent\" className='container'>\n      <h4> Upload </h4>\n      <br />\n      <form onSubmit={handleSubmit(onSubmit)}>\n\n      <Row className='propertyview ' key={'File'}>\n        <Col md={3}><label className=\"leftaligntext\"><b>File</b></label></Col>\n        <Col md={8}> <input className='leftaligntext inputfield' name='file' type=\"file\" ref={register({ required: true })} /></Col> \n      </Row> \n\n      <Row className='propertyview ' key={'Title'}>\n        <Col md={3}><label className=\"leftaligntext\"><b>Title</b></label></Col>\n        <Col md={8}><input className='leftaligntext inputfield' name='title' ref={register({ required: true })} /></Col> \n      </Row> \n\n\n      {/* TODO:: jump on enters */}\n      {keywordsfields.map(({ val }, index) => (\n        index === 0 \n        ? <Row className='propertyview ' key={'Keywords'+index} style={{'marginTop': 0, 'marginBottom': 0}}>\n            <Col md={3}> <label className=\"leftaligntext\"><b>Keywords</b></label> </Col>\n            <Col md={8}> <input className='leftaligntext inputfield' key={'keyword'+index} name={`keywords[${index}].val`} ref={register()} /> </Col>\n            <Col md={1}> <IconButton disabled type=\"button\"><CloseIcon style={{color: 'white'}} /></IconButton> </Col> {/* fix margins */}\n          </Row>\n        : <Row className='propertyview ' key={'Keywords'+index} style={{'marginTop': 0, 'marginBottom': 0}}>\n            <Col md={3} />\n            <Col md={8}> <input className='leftaligntext inputfield' key={'keyword'+index} name={`keywords[${index}].val`} ref={register()} /> </Col>\n            <Col md={1}> <IconButton type=\"button\" onClick={() => keywordsremove(index)}><CloseIcon style={{color: 'red'}} /></IconButton> </Col>\n          </Row>\n      ))}\n      <Row> <Col md={3} /> <Col md={1}> <IconButton type=\"button\" onClick={() => keywordsappend({val: ''})}><AddIcon style={{color: 'lightgreen'}} /></IconButton> </Col> </Row>\n\n      <Row className='propertyview ' key={'Date'}>\n        <Col md={3}><label className=\"leftaligntext\"><b>Date</b></label></Col>\n        <Col md={8}><input className='leftaligntext inputfield' type='date' name='date' ref={register({ required: true })} /></Col> \n      </Row>  \n\n      {/* TODO:: jump on enters */}\n      {authorsfields.map(({ webId }, index) => (\n        index === 0 \n        ? <Row className='propertyview ' key={'Authors'+index} style={{'marginTop': 0, 'marginBottom': 0}}>\n            <Col md={3}> <label className=\"leftaligntext\"><b>Authors</b></label> </Col>\n            <Col md={8}> <input className='leftaligntext inputfield' key={'author'+index} name={`authors[${index}].webId`} ref={register()} /> </Col>\n            <Col md={1}> <IconButton disabled type=\"button\"><CloseIcon style={{color: 'white'}} /></IconButton> </Col> {/* fix margins */}\n            <Col md={3} />\n            <Col md={8}><Profile control={control} index={index}/></Col>\n          </Row>\n        : <Row className='propertyview ' key={'Keywords'+index} style={{'marginTop': 0, 'marginBottom': 0}}>\n            <Col md={3} />\n            <Col md={8}> <input className='leftaligntext inputfield' key={'author'+index} name={`authors[${index}].webId`} ref={register()} /> </Col>\n            <Col md={1}> <IconButton type=\"button\" onClick={() => authorsremove(index)}><CloseIcon style={{color: 'red'}} /></IconButton> </Col>\n            <Col md={3} />\n            <Col md={8}><Profile control={control} index={index}/></Col>\n          </Row>\n      ))}\n      <Row> <Col md={3} /> <Col md={1}> <IconButton type=\"button\" onClick={() => authorsappend({webId:''})}><AddIcon style={{color: 'lightgreen'}} /></IconButton> </Col> </Row>\n\n      <Row className='propertyview ' key={'Abstract'}>\n        <Col md={3}><label className=\"leftaligntext\"><b>Abstract</b></label></Col>\n        <Col md={8}><textarea className='leftaligntext inputfield' name='abstract' ref={register({ required: true })} style={{'minHeight': '150px'}} /></Col> \n      </Row>  \n\n      <Row className='propertyview ' key={'Upload location'}>\n        <Col md={3}><label className=\"leftaligntext\"><b>Upload location</b></label></Col>\n        <Col md={8}><input className='leftaligntext inputfield' name='location' ref={register({ required: true })} /></Col> \n      </Row>  \n      \n      <br/>\n      <Button type=\"submit\">Submit</Button>\n    </form>\n    </div>\n  )\n}\n\n\nexport default UploadComponent","import React, { useState } from 'react';\n\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport Avatar from '@material-ui/core/Avatar';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\n\nimport \"./AsyncListItem.css\"\n\n\nconst AsyncListItemComment = (props) => {  \n\n  const [state, setstate] = useState({\n    comment: {\n      id: props.id,\n      replyOf: \"\",\n      createdAt: null,\n      creator: \"\",\n      content: \"\",\n      note: \"\",\n    },\n    creatorName: \"\"\n  })\n\n  // async initComponent(){\n  //   const comment = await this.cm.getCommentData(this.state.comment.id);\n  //   if(!this.running || !comment) return\n  //   this.props.updateDate({id: this.state.comment.id, date: comment.createdAt})\n  //   this.setState({comment: comment})\n  //   this.getCreatorName(comment.creator)\n  // }\n\n  // async getCreatorName(creatorId){\n  //   const name = await this.cm.getFullNameFromProfile(creatorId)\n  //   if(!this.running) return\n  //   if(name) this.setState({creatorName: name})\n  // }\n\n  // componentWillUnmount() {\n  //   this.running = false;\n  // }\n\n\n  // <ListItemAvatar>\n  //   <Avatar alt={this.state.creatorName} src={require(\"../assets/comment.svg\")}  />\n  // </ListItemAvatar>\n  \n  const timeString = state.comment.createdAt ? state.comment.createdAt.toLocaleString() : \"\";\n  const paperMetadata = Object.values(props.selection)[0]\n  const header = <div>{timeString} In reply to: <a href={state.comment.replyOf}>{paperMetadata.title}</a></div>\n  return (\n    <div key={props.id}>\n      <ListItem className=\"flex-start listitem\" >\n          <ListItemText\n            primary={header} \n            secondary={\n              <React.Fragment>\n                <Typography\n                  component=\"span\"\n                  variant=\"body2\"\n                  color=\"textPrimary\"\n                >\n                {state.creatorName}\n                </Typography>\n                {\" — \"}{state.comment.content}\n              </React.Fragment>\n            }\n          />\n      </ListItem>\n      <Divider variant=\"inset\" component=\"li\" />\n    </div>\n  )\n}\n\nexport default AsyncListItemComment","import React, { useState, useEffect } from 'react';\nimport \"./CommentAddComponent.css\"\nimport Row from 'react-bootstrap/Row'\nimport Col from 'react-bootstrap/Col'\nimport { createAndPostComment } from '../../util/MellonUtils/documents'\nimport { useForm } from 'react-hook-form';\nimport { getBaseIRI, routeViewWithParams, availableViews } from '../../util/Util';\nimport { Button } from 'react-bootstrap';\nimport ns from '../../util/NameSpaces';\n\nconst DEFAULTCOMMENTSFOLDER = 'public/'\n\n\nconst CommentAddComponent = (props) => {\n  const defaultlocation = props.webId ? getBaseIRI(props.webId) + DEFAULTCOMMENTSFOLDER : null\n\n  const { register, handleSubmit, control, reset, watch } = useForm({ defaultValues: {\n    comment: '',\n    location: defaultlocation\n  } })\n\n  const onSubmit = async (data) => {\n    console.log('handle submit', data)\n    const commentData = {\n      type: ns.sioc('Post'),\n      content: data.comment,\n      reply_of: props.documentId,\n      created_at: new Date().toISOString(),\n      has_creator: props.webId,\n      note: 'This post was created using the Mellon web application.',\n      location: data.location,\n      documentId: props.documentId\n    }\n\n    if (!props.metadataId) {\n      window.alert('Could not retrieve document metadata file.')\n      return\n    }\n    const submitted = await createAndPostComment(props.webId, commentData, props.metadataId)\n\n    if (! submitted) {\n      window.alert('Something went wrong while trying to upload your comment.')\n    }\n\n    reset({\n      comment: '',\n      location: defaultlocation\n    });\n  }\n\n  useEffect(() => {\n    const defaultlocation = props.webId ? getBaseIRI(props.webId) + DEFAULTCOMMENTSFOLDER : null\n    reset({\n      comment: '',\n      location: defaultlocation\n    });\n  }, [props.webId]);\n\n  return (\n    <div className=\"commentaddcontainer\">\n\n      <form onSubmit={handleSubmit(onSubmit)}>\n\n        <Row className='' key={'comment'}>\n          <Col md={12}><label className=\"leftaligntext\"><b>Comment</b></label></Col>\n        </Row>\n        <Row>\n          <Col md={12}><textarea className='leftaligntext inputfield' name='comment' ref={register({ required: true })} style={{'minHeight': '70px'}} /></Col> \n        </Row>\n        <br />\n        <Row className='' key={'storagefolder'}>\n          <Col sm={12} md={3}><label className=\"leftaligntext\"><b>Storage location</b></label></Col>\n          <Col sm={12} md={9}> <input className='leftaligntext inputfield' name='location' type=\"text\" ref={register({ required: true })} /></Col> \n        </Row>\n        <br/>\n        <Button type=\"submit\">Submit</Button>\n      </form>\n    </div>\n  );\n}\n\nexport default CommentAddComponent","import React, { useState, useEffect } from 'react';\nimport { getDocumentMetadata } from '../../util/MellonUtils/documents'\nimport AsyncListItemComment from './AsyncListItemComment';\nimport CommentAddComponent from './CommentAddComponent';\nimport { List } from '@material-ui/core';\nimport styles from '../../css/components/documentinfo.module.css'\n\nconst CommentsSidebar = (props) => {\n\n  const [state, setstate] = useState({\n    commentIds: [],\n    commentDates: [],\n  })\n  console.log('commentsdinges', props.documentId)\n\n\n  const updateDate = (updateObj) => {\n    console.log(\"updating date\", updateObj)\n    let newCommentDates = this.state.commentDates.slice();\n    for (let i = 0; i < newCommentDates.length; i++){\n      if(newCommentDates[i].id === updateObj.id) {\n        //the date as already been set once\n        return;\n      }\n    }\n    newCommentDates.push(updateObj)\n    setstate({commentIds: state.commentIds, commentDates: newCommentDates})\n  }\n\n\n  const getDateForId = (id) => {\n    let commentDates = this.state.commentDates\n    for (let e of commentDates){\n      if(e.id === id) {\n        return e\n      }\n    }\n    return {id: id, date: null};\n  }\n\n  let idsWithDates = state.commentIds.map(commentId => getDateForId(commentId))\n  console.log(\"idsWithDates\", JSON.stringify(idsWithDates, null, 2))\n  idsWithDates.sort(function(a, b) {console.log(\"comparing\", JSON.stringify(a), JSON.stringify(b)); if(!b.date) return a; if(!a.date) return b; return b.date.getTime() - a.date.getTime()})\n  console.log(\"sortedComments\", JSON.stringify(idsWithDates, null, 2))\n  let commentsList = idsWithDates.map(commentId => {return(\n    <AsyncListItemComment key={commentId.id} id={commentId.id} selection={props.selection} updateDate={updateDate}/>\n  )})\n  \n\n  return (\n    <div className={` ${styles.sidebarheight} sidebarcomponentcontainer`}>\n      <div className=\"uppercontainer\">\n        <p>Comments</p>\n        <List className={` ${styles.commentslist} disable-scrollbars`}>\n          {commentsList}\n        </List>\n      </div>\n      <div className={`${styles.addcommentfield} lowercontainer disable-scrollbars`}>\n        <CommentAddComponent className=\"commentAdd\" selection={props.selection} {...props} />\n      </div>\n    </div>\n  );\n}\n\nexport default CommentsSidebar\n\n\n","import React from 'react'\nimport { useTable } from 'react-table'\n\n/*\n  Copied parts of https://react-table.tanstack.com/docs/examples/editable-data\n*/\n\n// Create an editable cell renderer\nconst EditableCell = ({\n\tvalue: initialValue,\n\trow: { index },\n\tcolumn: { id },\n\tupdateMyData\n}) => {\n\tconst [value, setValue] = React.useState(initialValue);\n\t// If the initialValue is changed external, sync it up with our state\n\tReact.useEffect(() => {\n\t\tsetValue(initialValue);\n\t}, [initialValue]);\n\tconst onChange = e => {\n\t\tsetValue(e.target.value);\n\t}\n\t// We'll only update the external data when the input is blurred\n\tconst onBlur = () => {\n\t\tlet t_value = value.trim();\n\t\tupdateMyData(index, id, t_value.toLowerCase() === \"everyone\" ? null : t_value);\n\t}\n\treturn <input value={value === null ? \"Everyone\" : value} placeholder=\"WebID or 'Everyone'\" onChange={onChange} onBlur={onBlur} />;\n}\n\nconst CheckboxCell = ({\n\tvalue: initialValue,\n\trow: { index },\n\tcolumn: { id },\n\tupdateMyData\n}) => {\n\tconst [value, setValue] = React.useState(initialValue);\n\t// If the initialValue is changed external, sync it up with our state\n\tReact.useEffect(() => {\n\t\tsetValue(initialValue);\n\t}, [initialValue]);\n\n\tconst onChecked = e => {\n\t\tsetValue(e.target.checked);\n\t\tupdateMyData(index, id, e.target.checked);\n\t}\n\treturn <input type=\"checkbox\" value={value} onChange={onChecked} checked={value} />;\n}\n\nconst RemoveRowCell = ({ row: { index }, removeRow }) =>\n\t<div className=\"removeButton\" onClick={() => removeRow(index)}>X</div>\n\nconst CheckBoxHeader = ({\n\tcheckAll,\n\tcolumn: { id }\n}) => {\n\tconst [checked, setChecked] = React.useState(false);\n\n\tconst onClick = e => {\n\t\tcheckAll(id, !checked);\n\t\tsetChecked(!checked);\n\t}\n\treturn <>{id[0].toUpperCase() + id.slice(1)}<br/><input type=\"checkbox\" onClick={onClick} /></>\n}\n\n// Be sure to pass our updateMyData option\nexport default function AccessControlTable({ tableData, submitValues }) {\n\tconst columns = React.useMemo(\n\t\t() => [\n\t\t\t{\n\t\t\t\tHeader: 'Name',\n\t\t\t\taccessor: 'agent',\n\t\t\t\tCell: EditableCell\n\t\t\t}, {\n\t\t\t\tHeader: CheckBoxHeader,\n\t\t\t\taccessor: 'read',\n\t\t\t}, {\n\t\t\t\tHeader: CheckBoxHeader,\n\t\t\t\taccessor: 'write',\n\t\t\t}, {\n\t\t\t\tHeader: CheckBoxHeader,\n\t\t\t\taccessor: 'comment',\n\t\t\t}, {\n\t\t\t\tHeader: CheckBoxHeader,\n\t\t\t\taccessor: 'control',\n\t\t\t}, {\n\t\t\t\tHeader: '',\n\t\t\t\taccessor: 'deleteRow',\n\t\t\t\tCell: RemoveRowCell\n\t\t\t}\n\t\t],\n\t\t[]\n\t);\n\t// Set our editable cell renderer as the default Cell renderer\n\tconst defaultColumn = {\n\t\tCell: CheckboxCell,\n\t};\n\tconst [data, setData] = React.useState(tableData)\n\n\tReact.useEffect(\n\t\t() => setData(tableData),\n\t\t[tableData]\n\t)\n\n\tconst addRow = () => {\n\t\tdata.push({ agent: '', read: false, write: false, comment: false, control: false });\n\t\tsetData([...data]);\n\t}\n\n\tconst updateMyData = (rowIndex, columnId, value) => {\n\t\tsetData(old =>\n\t\t\told.map((row, index) => {\n\t\t\t\tif (index === rowIndex) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...old[rowIndex],\n\t\t\t\t\t\t[columnId]: value,\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn row;\n\t\t\t})\n\t\t)\n\t}\n\n\tconst removeRow = (rowIndex) => {\n\t\tdata.splice(rowIndex, 1);\n\t\tsetData([...data]);\n\t}\n\n\tconst checkAll = (id, checked) => {\n\t\tsetData(old =>\n\t\t\told.map(row => {\n\t\t\t\trow[id] = checked;\n\t\t\t\treturn row;\n\t\t\t})\n\t\t)\n\t}\n\n\tconst {\n\t\tgetTableProps,\n\t\tgetTableBodyProps,\n\t\theaderGroups,\n\t\trows,\n\t\tprepareRow\n\t} = useTable(\n\t\t{\n\t\t\tcolumns,\n\t\t\tdata,\n\t\t\tdefaultColumn,\n\t\t\tupdateMyData,\n\t\t\tremoveRow,\n\t\t\tcheckAll\n\t\t}\n\t)\n\n\t// Render the UI for your table\n\treturn (\n\t\t<>\n\t\t\t<table {...getTableProps()} className=\"access-control-table\">\n\t\t\t\t<thead>\n\t\t\t\t\t{headerGroups.map(headerGroup => (\n\t\t\t\t\t\t<tr {...headerGroup.getHeaderGroupProps()}>\n\t\t\t\t\t\t\t{headerGroup.headers.map(column => (\n\t\t\t\t\t\t\t\t<th {...column.getHeaderProps()}>{column.render('Header')}</th>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t))}\n\t\t\t\t</thead>\n\t\t\t\t<tbody {...getTableBodyProps()}>\n\t\t\t\t\t{rows.map((row, i) => {\n\t\t\t\t\t\tprepareRow(row)\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<tr {...row.getRowProps()}>\n\t\t\t\t\t\t\t\t{row.cells.map(cell => {\n\t\t\t\t\t\t\t\t\treturn <td {...cell.getCellProps()}>{cell.render('Cell')}</td>\n\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t)\n\t\t\t\t\t})}\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t\t<>\n\t\t\t\t<button onClick={addRow}>Add new</button>\n\t\t\t\t<button onClick={() => submitValues(data)}>Save permissions</button>\n\t\t\t</>\n\t\t</>\n\t)\n}\n","import React, { useEffect, useState } from 'react'\nimport AccessControlTable from './AccessControlTable'\n// import \"./AccessController.css\"\nimport { fetchProfile } from '../../util/MellonUtils/profile';\nimport { getPermissions, MODES, reCreateACL } from '../../util/PermissionManager';\nimport { getDocumentMetadataId } from '../../util/MellonUtils/documents';\n\nconst SUBMISSIONTIMEOUT = 3500\n\nconst AccessController = (props) => {\n\n\tconst [state, setstate] = useState({\n\t\tcontacts: [],\n\t\tpermissions: [], \n\t\tcommentPermissions: [],\n\t\ttableData: []\n\t})\n\n\tconst [submissionMessage, setSubmissionMessage] = useState(false)\n\n\tuseEffect(() => {\n\t\tlet mounted = true;\n\t\tif(!props.webId || !props.documentId) return;\n\t\tfetchData(props.documentId).then(newState => {\n\t\t\tif (mounted) setstate(newState)\n\t\t})\n\t\treturn () => {\n\t\t\tmounted = false;\n\t\t}\n\t}, [props.webId, props.documentId])\n\n\n\n\tconst fetchData = async () => {\n\t\tconst profile = await fetchProfile(props.webId) || null\n\t\tlet contacts = (profile && profile.contacts) || [];\n\t\tconst newState = {...state}\n\t\ttry {\n\t\t\tnewState.permissions = await getPermissions(props.webId, props.documentId);\n\t\t} catch {}\n\t\ttry {\n\t\t\tnewState.commentPermissions = await getPermissions(props.webId, await getDocumentMetadataId(props.webId, props.documentId));\n\t\t} catch {}\n\t\tnewState.tableData = createTableData(newState.permissions, newState.commentPermissions, contacts);\n\t\treturn newState\n\t}\n\n  const createTableData = (permissions, commentPermissions, contacts) => {\n\t\tcontacts = contacts || []\n\t\tlet tableData = []\n\t\tlet agentIndexes = {}\n\t\tlet newRow = {\n\t\t\tread: false,\n\t\t\twrite: false,\n\t\t\tcomment: false,\n\t\t\tcontrol: false\n\t\t}\n\n\t\tfunction processPermission(permission) {\n\t\t\tif (permission.agents === null) {\n\t\t\t\tpermission.agents = [null];\n\t\t\t}\n\t\t\tfor (let agent of permission.agents) {\n\t\t\t\tlet index = agentIndexes[agent];\n\t\t\t\tif (index === undefined) {\n\t\t\t\t\tindex = tableData.length;\n\t\t\t\t\tagentIndexes[agent] = index\n\t\t\t\t\t// Set because you can have a permission only once\n\t\t\t\t\ttableData.push({\n\t\t\t\t\t\t...newRow,\n\t\t\t\t\t\tagent\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tfor (let mode of permission.modes) {\n\t\t\t\t\ttableData[index][mode.toLowerCase()] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n    \tfor (let permission of permissions) {\n\t\t\tprocessPermission(permission)\n\t\t}\n\t\t// comment permissions\n\t\tfor (let permission of commentPermissions) {\n\t\t\tif (permission.modes.includes(MODES.APPEND) || permission.modes.includes(MODES.WRITE)) {\n\t\t\t\tpermission.modes = [MODES.COMMENT];\n\t\t\t\tprocessPermission(permission);\n\t\t\t}\n\t\t}\n\t\t// Contacs that don't have permission should also be displayed\n\t\tfor (let contact of contacts) {\n\t\t\tif (agentIndexes[contact] === undefined) {\n\t\t\t\tagentIndexes[contact] = tableData.length;\n\t\t\t\ttableData.push({\n\t\t\t\t\t...newRow,\n\t\t\t\t\tagent: contact\n\t\t\t\t});\n\t\t\t}\n\t\t}\n    \treturn tableData;\n\t}\n\n\t// // TODO: check valid webId's, groups, weird permissions (only write, owner no control, ...)\n\tconst submitValues = async (data) => {\n\t\tconsole.log('submitValues', data)\n\t\tlet permissions = [];\n\t\t// Comment is APPEND permission on metafile.\n\t\tlet commentPermissions = [];\n\n\t\tfunction addPermission(permissions, agent, modes) {\n\t\t\tif (!modes.length) { return permissions; }\n\t\t\tmodes.sort()\n\t\t\t// Always add new if the mode is for everyone\n\t\t\tif (agent === null) {\n\t\t\t\tpermissions.push({ agents: null, modes: modes});\n\t\t\t\treturn permissions;\n\t\t\t}\n\t\t\tfor (let permission of permissions) {\n\t\t\t\t// Assumes permission.modes is sorted\n\t\t\t\tif (permission.modes.join('') === modes.join('') && permission.agents !== null) {\n\t\t\t\t\tpermission.agents.push(agent);\n\t\t\t\t\treturn permissions;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Mode does not yet exist\n\t\t\tpermissions.push({ agents: [agent], modes: modes });\n\t\t\treturn permissions;\n\t\t}\n\n\t\tfor (let row of state.tableData) {  // 'row' is like { agent: 'bob', read: true, write: false ... }\n\t\t\tif (row.comment) {\n\t\t\t\tcommentPermissions = addPermission(commentPermissions, row.agent, [MODES.APPEND]);  // comment is APPEND on metadata file\n\t\t\t}\n\t\t\tlet modes = [];\n\t\t\tfor (let [mode, access] of [[MODES.READ, row.read], [MODES.WRITE, row.write], [MODES.CONTROL, row.control]]) {\n\t\t\t\tif (access) { modes.push(mode); }\n\t\t\t}\n\t\t\tpermissions = addPermission(permissions, row.agent, modes);\n\t\t}\n\t\t// webId, docURI, permissions\n\t\tconsole.log('permissions', permissions, commentPermissions)\n\t\tconst recreateAcl = await reCreateACL(props.webId, props.documentId, permissions);\n\t\tconst recreateMetadataAcl = await reCreateACL(props.webId, await getDocumentMetadataId(props.webId, props.documentId), commentPermissions);\n\n\t\t// Set submission message\n\t\tsetSubmissionMessage(true)\n\t\tsetTimeout(() => setSubmissionMessage(false), SUBMISSIONTIMEOUT)\n\t}\n\n\treturn (\n\t\t<>\n\t\t\t<p>Permissions for this file</p>\n\t\t\t<AccessControlTable tableData={state.tableData} submitValues={submitValues} />\n\t\t\t{submissionMessage && <p>The submission was successfull</p>}\n\t\t</>\n\t);\n\n\n}\n\nexport default AccessController","import React, { useEffect, useState } from 'react'\nimport { Row, Col, Button } from 'react-bootstrap'\nimport CommentsSidebar from './CommentsSidebar'\nimport AccessController from './AccessController'\nimport ResourceMissingComponent from '../ResourceMissingComponent'\nimport { getPublicationIds, getDocumentMetadata, getPublicationData, retrieveLDESEvents } from '../../util/MellonUtils/documents'\nimport { IconButton } from '@material-ui/core'\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\nimport { useHistory } from 'react-router-dom'\nimport { routeViewWithParams, availableViews } from '../../util/Util'\n\nconst DocumentInfoViewer = (props) => {\n  const userwebId = props.webId\n  const ownerWebId = props.selectedWebId || props.webId\n  const publicationId = props.documentId\n  const history = useHistory();\n\n  const [publicationData, setPublicationData] = useState(null)\n  const [publicationEvents, setPublicationEvents] = useState(null)\n\n  // Todo:: streaming retrieval of resources\n  useEffect(() => {\n    if(!publicationId) return\n    let mounted = true\n    getPublicationData(publicationId).then(data => {\n      if (mounted) setPublicationData(data)  \n    })\n  }, [publicationId])\n\n  useEffect(() => {\n    if (!publicationData || !publicationData.lifecycleEvents || !publicationData.lifecycleEvents[0]) return;\n    let mounted = true\n    retrieveLDESEvents(publicationData.lifecycleEvents[0]).then(events => {\n      if (mounted) setPublicationEvents(events)  \n    })\n  }, [publicationData])\n\n\n  const toPublications = () => {\n    const params = props.selectedWebId ? {selectedWebId: props.selectedWebId} : {}\n    const route = routeViewWithParams(availableViews.documents, params)\n    history.push(route);\n  }\n\n  // TODO:: replace dependency on metadata file to check if document file exists\n  if(!userwebId || !publicationId) return (\n    <div id=\"documentinfoviewer\" className='container'>\n      <Col md={2}><IconButton onClick={toPublications}><ArrowBackIcon /></IconButton></Col>\n      <ResourceMissingComponent />\n    </div>\n  )\n  \n  const getRepresentation = (key, publicationInfo) => {\n    if(!key) return null\n    switch (key) {\n      case 'date':\n        return publicationInfo[key].toLocaleString();\n      default:\n        return (\n          Array.isArray(publicationInfo[key]) \n            ? publicationInfo[key].join(', ') \n            : publicationInfo[key] \n        )\n    }\n  }\n  \n  const openFile = () => publicationData.file && window.open(publicationData.file)\n\n  return(\n    <div id=\"documentinfoviewer\" className='container'>\n      <Row>\n        <Col md={2}><IconButton onClick={toPublications}><ArrowBackIcon /></IconButton></Col>\n        <Col md={2}><Button onClick={openFile}>Open File</Button></Col>\n\n      </Row> \n      <Row>\n        <Col md={6} sm={12}>\n          {publicationData && ['title', 'date', 'authors', 'keywords', 'abstract'].map(key => \n            <Row className='' key={key} style={{height: 'auto'}}>\n              <Col md={3}><label className='leftaligntext'>{key}</label></Col>\n              <Col md={9}><label className='leftaligntext'>{getRepresentation(key, publicationData)}</label></Col>\n            </Row>\n          )}\n          <br />\n          <br />\n          <AccessController webId={userwebId} documentId={publicationData} />\n        </Col>\n        <Col md={6} sm={12}>\n          <CommentsSidebar webId={userwebId} documentId={publicationData} />\n        </Col>\n      </Row>\n    </div>\n  )\n}\n\nexport default DocumentInfoViewer","/**\n * Create the follow event notification\n * @param {string} webId \n * @param {{topic: string, value: string}[]} objects \n */\nexport const createFollowEventNotification = (webId, objects) => {\n  if (!objects || objects === null) {\n    throw new Error('Creating subscription notification without subscription targets.')\n  }\n  const notif = {\n    \"@context\": \"https://www.w3.org/ns/activitystreams\",\n    \"summary\": \"Subscription event\",\n    \"@type\": \"Follow\",\n    \"object\": [ ],\n    \"actor\": {\n      \"@id\": webId,\n      \"@type\": \"Person\",\n    },\n  }\n\n  for (let object of objects) {\n    if (!object.topic || !object.value) {\n      throw new Error('Incorrect subscription format.')\n    }\n    notif['object'].push({\n      \"https://www.example.org/ontology#property\": object.topic,\n      \"https://www.example.org/ontology#propertyValue\": object.value\n    })\n  }\n\n  return JSON.stringify(notif, null, 2)\n}\n","import { FormControl, Input, InputLabel, makeStyles, MenuItem, Select } from '@material-ui/core';\nimport React, { useState, useEffect } from 'react';\nimport { Row, Col, Button } from 'react-bootstrap';\nimport { Subscription, SubscriptionTopic } from 'util/Util';\nimport { useForm } from \"react-hook-form\";\nimport styles from '../css/components/profilecard.module.css'\nimport { createFollowEventNotification } from 'util/MellonUtils/notifications';\nimport { getInboxAgent } from 'singletons/InboxAgent';\n\n// TODO:: on error, reload page\n\nconst useStyles = makeStyles((theme) => ({\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120,\n  },\n  selectEmpty: {\n    marginTop: theme.spacing(2),\n  },\n  dividerDiv: {\n    \"height\": \"10px\"\n  }\n}));\n\nconst SubscriptionComponent = (props) => {\n\n  const [addSubView, setAddSubView] = useState(false)\n\n  const [subscriptions, setSubscriptions] = useState([\n    new Subscription(SubscriptionTopic.AUHTORID, \"https://carol.localhost:8443/profile/card#me\", \"https://myservice.com/subscriptions/\", 1),\n    new Subscription(SubscriptionTopic.KEYWORD, \"test\", \"https://myservice.com/subscriptions/\", 2),\n    new Subscription(SubscriptionTopic.TITLE, \"Test title\", \"https://myservice.com/subscriptions/\", 3),\n    new Subscription(SubscriptionTopic.ARTEFACTID, \"https://carol.localhost:8443/publications/publication.ttl\", \"https://myservice.com/subscriptions/\", 4),\n  ])\n\n  const submitSubscription = async(subscription) => {\n\n    const notification = createFollowEventNotification(props.webId, [subscription])\n    const agent = getInboxAgent(props.webId)\n    // await dosomething\n    // on success\n    agent.sendNotification({\n      to: [ props.webId ],\n      contentType: \"application/ld+json\",\n      contentTypeOutput: \"application/ld+json\",\n      notification: notification,\n    })\n\n    const newstate = subscriptions.slice()\n    newstate.push(subscription)\n    setSubscriptions(newstate)\n    setAddSubView(false)\n  }\n\n  const removeSubscription = async(subscription) => {\n    // remove remote subscription\n    // on success\n    let newstate = subscriptions.slice()\n    newstate = newstate.filter(s => s.id !== subscription.id)\n    setSubscriptions(newstate)\n  }\n\n  const subscriptionListing = (subscription) => {\n    return (\n      <div>\n        <div className={styles.container}>\n          <Row key={subscription.id || Math.round(Math.random() * 100)}>\n            <Col> {subscription.topic} </Col>\n            <Col> {subscription.value} </Col>\n            <Col> {subscription.url} </Col>\n            { subscription.id\n              ? <Col><Button onClick={ () => removeSubscription(subscription)}> {\"X\"} </Button></Col> \n              : <Col>Pending</Col>}\n          </Row>\n        </div>\n        <div style={{height: \"5px\"}} />\n      </div>\n    )\n  }\n\n\n  return (\n    <div id=\"subscrptioncomponent\" className='container'>\n      <h4> Subscriptions </h4>\n      {\n        addSubView\n          ? <SubscriptionCreateComponent onSubmit={(item) => submitSubscription(item)}/>\n          : <Button onClick={() => setAddSubView(true)}>Add new subscription</Button>\n      }\n      <div style={{height: \"20px\"}} />\n      <div className=\"subscriptionListings\">\n        <Row>\n          <Col><b>Topic</b></Col>\n          <Col><b>Value</b></Col>\n          <Col><b>Service URL</b></Col>\n          <Col><b>Remove subscription</b></Col>\n        </Row>\n        <div style={{height: \"5px\"}} />\n        {subscriptions.map(s => subscriptionListing(s))}\n      </div>\n      <div className=\"subscriptionCreation\"></div>\n    </div>\n  )\n}\n\nconst SubscriptionCreateComponent = (props) => {\n  const { register, handleSubmit, errors } = useForm();\n  const onSubmit = data => { \n    console.log(data);\n    const subscriptionObject = new Subscription(data.topic, data.value, data.url)\n    props.onSubmit(subscriptionObject)\n  }\n\n  return (\n    <div id=\"createsubscriptioncomponent\" className={styles.container}>\n      <form onSubmit={handleSubmit(onSubmit)}>\n        <Row>\n          <Col><b>Topic</b></Col>\n          <Col><b>Value</b></Col>\n        </Row>\n        <Row>\n          <Col>\n          <select name='topic' ref={register({ required: true })}>\n            <option value={SubscriptionTopic.ARTEFACTID}>artefact</option>\n            <option value={SubscriptionTopic.AUHTORID}>author</option>\n            <option value={SubscriptionTopic.KEYWORD}>keyword</option>\n            <option value={SubscriptionTopic.TITLE}>title</option>\n          </select>\n          </Col>\n          <Col><input name=\"value\" className=\"inputfield\" ref={register({ required: true })} /></Col>\n        </Row>\n        <Row>\n          <Col>\n            {errors.topic && <span className=\"errortext\">This field is required</span>}\n          </Col>\n          <Col>\n            {errors.value && <span className=\"errortext\">This field is required</span>}\n          </Col>\n        </Row>\n        <Row>\n          <input type=\"submit\" />    \n        </Row>\n      </form>\n    </div>\n  )\n}\n\nexport default SubscriptionComponent\n\n","import React, { useState } from 'react'\nimport ReactLoading from 'react-loading';\nimport { LiveUpdate } from '@solid/react';\nimport { withWebId } from '@inrupt/solid-react-components'\n\nconst withContent = (initview, popupmessage) =>   \n  withWebId((props) => {\n    const [view, setview] = useState(initview)\n    const selectedWebId = new URLSearchParams(props.location.search+props.location.hash).get(\"selectedWebId\")\n    const documentId = new URLSearchParams(props.location.search+props.location.hash).get(\"documentId\")\n    const newProps = {...props, setview, selectedWebId, documentId}\n    const component = view.generation(newProps)\n    \n    if (popupmessage) alert(popupmessage)\n    \n    return (\n      <div id=\"mainscreencontainer\" className='container'>\n        <LiveUpdate>\n          {component}\n        </LiveUpdate>\n      </div>\n    )\n})\n\nexport default withContent\n","import React from 'react'\nimport * as N3 from 'n3'\nimport NotificationsViewerComponent from '../Components/NotificationsViewerComponent'\nimport ProfileViewerComponent from '../Components/Views/ProfileViewerComponent'\nimport ProfileEditorComponent from '../Components/ProfileEditorComponent'\nimport HelpComponent from '../Components/Help/HelpComponent'\nimport LoginComponent from '../Components/Login/LoginComponent'\n\nimport PersonIcon from '@material-ui/icons/Person';\nimport NotificationsIcon from '@material-ui/icons/Notifications';\n\nimport HelpIcon from '@material-ui/icons/Help';\nimport InsertDriveFileIcon from '@material-ui/icons/InsertDriveFile';\nimport CardMembershipIcon from '@material-ui/icons/CardMembership';\nimport ListIcon from '@material-ui/icons/List';\nimport GavelIcon from '@material-ui/icons/Gavel';\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp';\nimport ContactsIcon from '@material-ui/icons/Contacts';\nimport DynamicFeedIcon from '@material-ui/icons/DynamicFeed';\nimport PublishIcon from '@material-ui/icons/Publish';\nimport AssistantPhotoIcon from '@material-ui/icons/AssistantPhoto';\n\nimport FeedComponent from '../Components/Views/FeedComponent'\nimport DocumentsViewerComponent from '../Components/Views/DocumentsViewerComponent'\nimport ContactsComponent from '../Components/Views/ContactsComponent'\nimport ResourceMissingComponent from '../Components/ResourceMissingComponent'\nimport UploadComponent from '../Components/Views/UploadComponent'\nimport DocumentInfoViewer from '../Components/Documents/DocumentInfoViewer'\nimport SubscriptionComponent from '../Components/SubscriptionComponent'\nimport { Switch, Route } from 'react-router-dom'\nimport withContent from '../HOC/withContent'\n\nexport const validStatusCodes = [200, 201, 202]\n\nexport async function getPromiseValueOrUndefined (promise){\n  try { return await promise.value }\n  catch { return undefined }\n}\n\n/**\n * The available views that can be set, with the required information\n */\nexport const availableViews = {\n  login:          {id:\"login\",            label:'Login',            component: LoginComponent,                generation:(props) => <LoginComponent {...props}/>,               icon: <ExitToAppIcon />,        target: '/login',         newtab: false},\n  profile:        {id:\"profile\",          label:'Profile',          component: ProfileViewerComponent,        generation:(props) => <ProfileViewerComponent {...props}/>,       icon: <PersonIcon />,           target: '/profile',       newtab: false},\n  profileeditor:  {id:\"profileedit\",      label:'Profile Editor',   component: ProfileEditorComponent,        generation:(props) => <ProfileEditorComponent {...props}/>,       icon: <HelpIcon />,             target: '/profileedit',   newtab: false},\n  notifications:  {id:\"notifications\",    label:'Notifications',    component: NotificationsViewerComponent,  generation:(props) => <NotificationsViewerComponent {...props}/>, icon: <NotificationsIcon />,    target: '/notifications', newtab: false},\n  help:           {id:\"help\",             label:'Help',             component: HelpComponent,                 generation:(props) => <HelpComponent {...props}/>,                icon: <HelpIcon />,             target: '/help',          newtab: true},\n  feed:           {id:\"feed\",             label:'Feed',             component: FeedComponent,                 generation:(props) => <FeedComponent {...props}/>,                icon: <DynamicFeedIcon />,      target: '/feed',          newtab: false},\n  documents:      {id:\"documents\",        label:'Publications',     component: DocumentsViewerComponent,      generation:(props) => <DocumentsViewerComponent {...props}/>,     icon: <InsertDriveFileIcon />,  target: '/documents',     newtab: false},\n  contacts:       {id:\"contacts\",         label:'Following',        component: ContactsComponent,             generation:(props) => <ContactsComponent {...props}/>,            icon: <ContactsIcon />,         target: '/contacts',      newtab: false},\n  missing:        {id:\"missing\",          label:'Resource Missing', component: ResourceMissingComponent,      generation:(props) => <ResourceMissingComponent {...props}/>,     icon: <HelpIcon />,             target: '/missing',       newtab: false},\n  upload:         {id:\"upload\",           label:'Upload',           component: UploadComponent,               generation:(props) => <UploadComponent {...props}/>,              icon: <PublishIcon />,          target: '/upload',        newtab: false},\n  documentinfo:   {id:\"documentinfo\",     label:'Document info',    component: DocumentInfoViewer,            generation:(props) => <DocumentInfoViewer {...props}/>,           icon: <HelpIcon />,             target: '/docinfo',       newtab: false},\n  listsub:        {id:\"subcriptions\",     label:'Subcriptions',     component: SubscriptionComponent,         generation:(props) => <SubscriptionComponent {...props}/>,        icon: <AssistantPhotoIcon />,   target: '/subscriptions', newtab: false},\n}\n\nexport const getAvailableRoutes = () => {\n  return(\n    <Switch>\n      {Object.keys(availableViews).map((viewId, index) => \n        <Route exact path={availableViews[viewId].target} key={availableViews[viewId].id} component={withContent(availableViews[viewId])} key={index}/>\n      )}\n      <Route path='' key='defaultroute' component={withContent(availableViews.missing)} />\n    </Switch>\n  )\n}\n\n/**\n * Mapping to see which sidebar item should be displayed as selected per view.\n */\nexport const activeDrawerItemMapping = {\n  profile:          \"profile\",\n  profileeditor:    \"profile\",\n  requests:         \"requests\",\n  marriagerequest:  \"requests\",\n  running:          \"running\",\n  marriageview:     \"running\",\n  certificates:     \"certificates\",\n  certificateview:  \"certificates\",\n  official:         \"official\",\n  submissionview:   \"official\",\n  notifications:    \"notifications\",\n  help:             \"help\",\n  listsub:          \"listsub\",\n}\n\n\nexport function formatDate(date) {\n  date = new Date(date)\n  var dd = String(date.getDate()).padStart(2, '0');\n  var mm = String(date.getMonth() + 1).padStart(2, '0'); //January is 0!\n  var yyyy = date.getFullYear();\n  return (mm + '/' + dd + '/' + yyyy)\n}\n\nexport function getCleanedIRI(IRI) {\n  return IRI.split(\"#\")[0];\n}\n\nexport function getBaseIRI(IRI) {\n  let path = IRI;\n  path = path.replace(/(^\\w+:|^)\\/\\//, \"\");\n  path = path.split(\"/\").slice(1).join(\"/\");\n  path =\n    IRI.substring(0, IRI.indexOf(path)).replace(/\\/$/, \"\") +\n    \"/\";\n  return path;\n}\n\nexport function routeViewWithParams (view, params) {\n  const route = view.target;\n  let paramString = '?'\n  for (const [key, value] of Object.entries(params)) {\n    if(value) paramString += `${key}=${params[key]}&` \n  }\n  return paramString === '?' ? route : route+paramString.slice(0, -1) // slice away last & sign\n\n}\n\n\nexport const SubscriptionTopic = {\n  AUHTORID: \"authorId\",\n  ARTEFACTID: \"artefactId\",\n  KEYWORD: \"keyword\",\n  TITLE: \"title\",\n}\nexport class Subscription {\n  constructor (topic, value, url, id) {\n    this.topic = topic;\n    this.value = value;\n    this.url = url;\n    this.id = id;\n  }\n}","import React, { useState } from 'react';\nimport clsx from 'clsx';\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\nimport Drawer from '@material-ui/core/Drawer';\nimport AppBar from '@material-ui/core/AppBar';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport List from '@material-ui/core/List';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport { availableViews, getAvailableRoutes } from '../util/Util';\nimport useNotifications from '../hooks/useNotifications';\nimport { withWebId } from '@inrupt/solid-react-components';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Badge from '@material-ui/core/Badge';\nimport { LogoutButton, LoggedIn, LoggedOut  } from '@solid/react';\n\nimport '../css/Drawer.css'\n\n\n// import solidlogo from '../assets/solid-emblem.svg';\n// import idlablogo from '../assets/idlab.png';\nimport { Route, Link, BrowserRouter as Router, Switch, Redirect } from 'react-router-dom'\nimport LoginComponent from './Login/LoginComponent';\nimport withContent from '../HOC/withContent';\n\nvar drawerWidth = 240;\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    display: 'flex',\n  },\n  appBar: {\n    zIndex: theme.zIndex.drawer + 1,\n    transition: theme.transitions.create(['width', 'margin'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n  },\n  appBarShift: {\n    marginLeft: drawerWidth,\n    width: `calc(100% - ${drawerWidth}px)`,\n    transition: theme.transitions.create(['width', 'margin'], {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n  },\n  menuButton: {\n    marginRight: 36,\n  },\n  hide: {\n    display: 'none',\n  },\n  drawer: {\n    width: drawerWidth,\n    flexShrink: 0,\n    whiteSpace: 'nowrap',\n  },\n  drawerOpen: {\n    width: drawerWidth,\n    transition: theme.transitions.create('width', {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.enteringScreen,\n    }),\n  },\n  drawerClose: {\n    transition: theme.transitions.create('width', {\n      easing: theme.transitions.easing.sharp,\n      duration: theme.transitions.duration.leavingScreen,\n    }),\n    overflowX: 'hidden',\n    width: theme.spacing(7) + 1,\n    [theme.breakpoints.up('sm')]: {\n      width: theme.spacing(9) + 1,\n    },\n  },\n  toolbar: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'flex-end',\n    padding: theme.spacing(0, 1),\n    // necessary for content to be below app bar\n    ...theme.mixins.toolbar,\n  },\n  content: {\n    flexGrow: 1,\n    padding: theme.spacing(3),\n  },\n}));\n\nconst NavBarWrapper = withWebId((props) => {\n  const [open, setOpen] = React.useState(true);\n\n\n  // const isActive = (item) => item.id === activeDrawerItemMapping[selectedView.id]\n  // TODO:: fix this with new routing to display grey border around appropriate sidebar item\n  const isActive = (item) => false;\n\n  const getSidebarComponent = (itemName, index) => { \n    const item = availableViews[itemName]\n    switch (itemName) {\n      case 'divider':\n        return (<Divider key={index}/>)\n      case 'br':\n        return (<br key={index}/>)\n      default:\n        if (!item) return <div />\n        return (\n          <Link to={item.target} target={item.newtab ? \"_blank\" : undefined} style={{ textDecoration: 'none', color: \"black\" }} key={index}>\n            <ListItem button={true} className={isActive(item) ? 'active' : 'nonactive'} key={index}>\n              <ListItemIcon>{item.icon}</ListItemIcon>\n              <ListItemText primary={item.label} />\n            </ListItem>\n          </Link>\n        )\n    }\n  }\n\n  // const openApp = () => { if(window.location.endsWith('help')) window.open(window.location)\n  // const openHelp = () => window.open(window.location + 'help')\n\n  const getTopBarComponent = (itemName, index) => {\n    const item = availableViews[itemName]\n    const className = index === 0 ? 'topmenuitem topmenuitemleft' : 'topmenuitem'\n    switch (itemName) {\n      case 'notifications':\n        return (\n          <Link to={item.target} className={className}  target={item.newtab ? \"_blank\" : undefined} key={index }>\n            <NotificationsMenuItem item={item} webId={props.webId} index={index} key={'topmenuitem' + index}/>\n          </Link>\n        )\n      default:\n        return (\n          <Link to={item.target} className={className}  target={item.newtab ? \"_blank\" : undefined} key={index }>\n            <MenuItem key={index}>\n              <IconButton aria-label={item.label} style={{color: \"white\"}}>\n                  {item.icon}\n              </IconButton>\n            </MenuItem>\n          </Link>\n        )\n    }\n  }\n\n  const sideBarItems = props.sideBarItems || []\n  const sidebarComponents = sideBarItems.map((e, index) => getSidebarComponent(e, index))\n\n  const topBarItems = props.topBarItems || []\n  const topbarComponents = topBarItems.map((e, index) => getTopBarComponent(e, index))\n\n  const handleDrawerOpen = () => setOpen(true);\n\n  const handleDrawerClose = () => setOpen(false);\n\n  drawerWidth = sidebarComponents.length ? drawerWidth : 0;\n\n  const classes = useStyles();\n  const theme = useTheme();\n\n  // <Navbar.Brand href=\"https://solidproject.org/\">\n  //   <img\n  //     alt=\"\"\n  //     width='50px'\n  //     src={solidlogo}\n  //   />{' '}\n  // </Navbar.Brand>\n\n  // <Navbar.Brand href=\"https://www.ugent.be/ea/idlab/en\">\n  //   <img\n  //     alt=\"\"\n  //     src={idlablogo}\n  //     height=\"40px\"\n  //   />{' '}\n  // </Navbar.Brand>\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar\n        position=\"fixed\"\n        className={clsx(classes.appBar, {\n          [classes.appBarShift]: open,\n        })}\n      >\n        <Toolbar>\n          <IconButton\n            color=\"inherit\"\n            aria-label=\"open drawer\"\n            onClick={handleDrawerOpen}\n            edge=\"start\"\n            className={clsx(classes.menuButton, {\n              [classes.hide]: open,\n            })}\n          >\n            <MenuIcon />\n          </IconButton>\n\n          <Link to=\"/\" target=\"_blank\">\n            <Typography variant=\"h6\" style={{color: \"white\"}} noWrap>\n              Mellon\n            </Typography>\n          </Link>\n\n          {topbarComponents}\n          {props.hidelogout \n            ? <div />\n            : <MenuItem className='topmenuitem'>\n                <LogoutButton className=\"logoutButton\"/>\n              </MenuItem>}\n\n        </Toolbar>\n      </AppBar>\n      {sidebarComponents.length\n      ?\n        <Drawer\n          variant=\"permanent\"\n          className={`${clsx(classes.drawer, {\n            [classes.drawerOpen]: open,\n            [classes.drawerClose]: !open,\n          })} sidebar`}\n          classes={{\n            paper: clsx({\n              [classes.drawerOpen]: open,\n              [classes.drawerClose]: !open,\n            }),\n          }}\n        >\n          <Toolbar className={`${classes.toolbar} toolbarcolor`}>\n            <IconButton onClick={handleDrawerClose}>\n              {theme.direction === 'rtl' ? <ChevronRightIcon style={{fill: \"white\"}}/> : <ChevronLeftIcon style={{fill: \"white\"}}/>}\n            </IconButton>\n          </Toolbar>\n          <Divider />\n          <div className='sidebarcontent'>\n            <List>\n              {sidebarComponents}\n            </List>\n          </div>\n        </Drawer>\n      : <div />}\n      \n      <main className={classes.content}>\n        <Toolbar />\n          <LoggedOut>\n            <Switch>\n              <Route exact path={'/login'} key={availableViews.login.id} component={withContent(availableViews.login)} />\n              <Redirect to=\"/login\" />\n            </Switch>\n          </LoggedOut>\n          <LoggedIn>\n            {getAvailableRoutes()}\n          </LoggedIn>\n      </main>\n    </div>\n  );\n})\n\nexport default NavBarWrapper\n\nconst NotificationsMenuItem = (props) => {\n  const item = availableViews.notifications;\n  const notifications = useNotifications(props.webId)\n  return (\n    <MenuItem className={props.className} key={props.index}>\n      <IconButton aria-label={item.label} color=\"inherit\" style={{color: 'white'}} >\n          <Badge badgeContent={notifications.length} color=\"secondary\">\n            {item.icon}\n          </Badge>\n      </IconButton>\n    </MenuItem>\n  )\n}","import React, { useEffect } from 'react'\nimport './App.css'\nimport 'bootstrap/dist/css/bootstrap.min.css'\nimport { LoggedIn, LoggedOut } from '@solid/react'\nimport NavBarWrapper from './Components/NavBarWrapper'\nfunction App () {\n\n\n  const loginviewcomponents = {\n    defaultview:'login',\n    sideBarItems:['login', 'help'],\n    topBarItems:['help'],\n    hidelogout: true,\n  }\n\n  const mainviewcomponents = {\n    defaultView: 'profile',\n    sideBarItems: ['divider', 'profile', 'divider', 'documents', 'divider', 'feed', 'divider', 'contacts', 'divider', 'listsub', 'divider', 'br', 'divider', 'upload', 'divider'],\n    topBarItems: ['notifications', 'help'],\n    hidelogout: false,\n  }\n\n  useEffect(() => {\n    document.title = \"Mellon\";\n  }, []);\n\n\n  return (\n    <div className=\"App\">\n      <LoggedIn>\n        <NavBarWrapper defaultview={mainviewcomponents.defaultview} \n                        sideBarItems={mainviewcomponents.sideBarItems} \n                        topBarItems={mainviewcomponents.topBarItems} \n                        hidelogout={mainviewcomponents.hidelogout} />\n      </LoggedIn>\n      <LoggedOut>\n        <NavBarWrapper defaultview={loginviewcomponents.defaultview} \n                        sideBarItems={loginviewcomponents.sideBarItems} \n                        topBarItems={loginviewcomponents.topBarItems} \n                        hidelogout={loginviewcomponents.hidelogout} />\n      </LoggedOut>\n    </div>\n  )\n}\n\nexport default App\n","import React, { useState, useEffect } from 'react'\nimport NavBarWrapper from '../NavBarWrapper'\n\nexport default function HelpContainerComponent() {\n\n  useEffect(() => {\n    document.title = \"Mellon - Help\";\n  }, []);\n\n  return (\n    <div>\n    <h1>{`${window.location}`}</h1>\n    <NavBarWrapper defaultview='help' sideBarItems={[]} topBarItems={[]} hidelogout={true}></NavBarWrapper>\n    </div>\n    \n  )\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport HelpContainerComponent from './Components/Help/HelpContainerComponent'\nimport * as serviceWorker from './serviceWorker';\nimport { Route, Link, BrowserRouter as Router, Switch } from 'react-router-dom'\n\n\n// Disabled strict mode because of issues with MaterialUI components such as Tooltip\nReactDOM.render(\n  \n    <Router>\n      <Switch>\n        <Route path=\"/help\">\n          <HelpContainerComponent />\n        </Route>\n        {/* The default route */}\n        <Route path=\"/\">\n          <App />\n        </Route>\n      </Switch>\n    </Router>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.notifySystem = exports.toReadableStream = exports.quadsToString = exports.streamToQuads = exports.DEFAULTFILTERNAME = void 0;\nconst SolidError_1 = __importDefault(require(\"./SolidError\"));\nconst NameSpaces_1 = __importDefault(require(\"../NameSpaces\"));\nconst rdf_serialize_1 = __importDefault(require(\"rdf-serialize\"));\nconst SystemNotificationhandler_1 = require(\"../SystemNotifications/SystemNotificationhandler\");\nconst streamifyArray = require('streamify-array');\nconst streamifyString = require('streamify-string');\nconst stringifyStream = require('stream-to-string');\nexports.DEFAULTFILTERNAME = 'default';\nexports.streamToQuads = (stream) => {\n    return new Promise((resolve, reject) => {\n        const quads = [];\n        stream\n            .on('data', (quad) => { quads.push(quad); })\n            .on('error', (error) => reject(new SolidError_1.default(`Error parsing notification body.\\n${error.message}`, \"Notification parsing\")))\n            .on('end', () => resolve(quads));\n    });\n};\nexports.quadsToString = (quads, contentType) => {\n    contentType = contentType || 'application/ld+json';\n    const notificationQuadStream = streamifyArray(quads);\n    const notificationTextStream = rdf_serialize_1.default.serialize(notificationQuadStream, { contentType: contentType });\n    return stringifyStream(notificationTextStream);\n};\n/**\n * Converts a WhatWG streams to Node streams if required.\n * Returns the input in case the stream already is a Node stream.\n * @param {ReadableStream} body\n * @returns {NodeJS.ReadableStream}\n */\nfunction toReadableStream(body) {\n    return require('is-stream')(body) ? body : require('web-streams-node').toNodeReadable(body);\n}\nexports.toReadableStream = toReadableStream;\n/**\n * Send system notifications for both node and browser\n * @param quads The notification quads\n * @param formattingFunction A formatting function to format the quads into a notification\n */\nfunction notifySystem(quads, formattingFunction, filterName, date) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const f = function (quads) {\n            return __awaiter(this, void 0, void 0, function* () {\n                let sender = null;\n                let contents = null;\n                for (let quad of quads) {\n                    if (quad.predicate.value === NameSpaces_1.default.dct('creator')) {\n                        sender = quad.object.value;\n                    }\n                    if (quad.predicate.value === NameSpaces_1.default.as('content')) {\n                        contents = quad.object.value;\n                    }\n                }\n                if (!contents) {\n                    contents = yield exports.quadsToString(quads, 'text/turtle');\n                }\n                date;\n                if (date) {\n                    contents = `Received: ${date}\\n` + contents;\n                }\n                if (filterName) {\n                    contents = `Filter: ${filterName}\\n` + contents;\n                }\n                if (sender) {\n                    contents = `Sender: ${sender}\\n` + contents;\n                }\n                return contents;\n            });\n        };\n        const message = formattingFunction ? yield formattingFunction(quads) : yield f(quads);\n        new SystemNotificationhandler_1.SystemNotificationHander().notify({\n            title: 'Solid notification',\n            message,\n        });\n    });\n}\nexports.notifySystem = notifySystem;\n//# sourceMappingURL=util.js.map","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sidebarheight\":\"documentinfo_sidebarheight__11eUy\",\"commentslist\":\"documentinfo_commentslist__3d1dp\",\"addcommentfield\":\"documentinfo_addcommentfield__IluFf\"};","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getDataset = exports.getResourceAsDataset = exports.RDFStreamToQuads = exports.getResourceAsQuadArray = exports.getResourceAsRDFStream = exports.getResourceAsTextStream = exports.getResourceAsText = void 0;\nconst FileUtils_1 = require(\"../Utils/FileUtils\");\nconst fs_1 = require(\"fs\");\nconst browser_or_node_1 = require(\"browser-or-node\");\nconst rdf_parse_1 = __importDefault(require(\"rdf-parse\"));\nconst SolidError_1 = __importDefault(require(\"../Utils/SolidError\"));\nconst factory = require('rdf-ext');\nfunction getResourceAsText(auth, path) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (isRemote(path)) {\n            return yield getRemoteResourceAsText(auth, path);\n        }\n        else {\n            if (!browser_or_node_1.isBrowser) {\n                return yield getLocalResourceAsText(path);\n            }\n            throw new SolidError_1.default('Local file paths in a browser environment are not yet supported');\n        }\n    });\n}\nexports.getResourceAsText = getResourceAsText;\nfunction getResourceAsTextStream(auth, path) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (isRemote(path)) {\n            return yield getRemoteResourceAsTextStream(auth, path);\n        }\n        else {\n            if (!browser_or_node_1.isBrowser) {\n                return yield getLocalResourceAsTextStream(path);\n            }\n            throw new SolidError_1.default('Local file paths in a browser environment are not yet supported');\n        }\n    });\n}\nexports.getResourceAsTextStream = getResourceAsTextStream;\nfunction getResourceAsRDFStream(auth, path, content_type) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (isRemote(path)) {\n            return yield getRemoteResourceAsRDFStream(auth, path);\n        }\n        else {\n            if (!browser_or_node_1.isBrowser) {\n                return yield getLocalResourceAsRDFStream(path, content_type);\n            }\n            throw new SolidError_1.default('Local file paths in a browser environment are not yet supported');\n        }\n    });\n}\nexports.getResourceAsRDFStream = getResourceAsRDFStream;\nfunction getResourceAsQuadArray(auth, path, content_type) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (isRemote(path)) {\n            return yield getRemoteResourceAsQuadArray(auth, path);\n        }\n        else {\n            if (!browser_or_node_1.isBrowser) {\n                return yield getLocalResourceAsQuadArray(path, content_type);\n            }\n            throw new SolidError_1.default('Local file paths in a browser environment are not yet supported');\n        }\n    });\n}\nexports.getResourceAsQuadArray = getResourceAsQuadArray;\nfunction isRemote(path) {\n    let remoteURL = true;\n    try {\n        new URL(path);\n    }\n    catch (e) {\n        remoteURL = false;\n    }\n    return remoteURL;\n}\n// Functions to fetch different formats of a local resourcevs ReadableStream\nconst getLocalResourceAsText = (path) => __awaiter(void 0, void 0, void 0, function* () { return fs_1.readFileSync(path, { encoding: 'utf-8' }); });\nconst getLocalResourceAsTextStream = (path) => __awaiter(void 0, void 0, void 0, function* () { return fs_1.createReadStream(path); });\nconst getLocalResourceAsRDFStream = (path, content_type) => __awaiter(void 0, void 0, void 0, function* () {\n    const textStream = yield getLocalResourceAsTextStream(path);\n    return rdf_parse_1.default.parse(textStream, { path: path, contentType: content_type, baseIRI: path });\n});\nconst getLocalResourceAsQuadArray = (path, content_type) => __awaiter(void 0, void 0, void 0, function* () {\n    const rdfStream = yield getLocalResourceAsRDFStream(path, content_type);\n    return exports.RDFStreamToQuads(rdfStream);\n});\n// Functions to fetch different formats of a local resource\nconst getRemoteResourceAsText = (auth, uri) => __awaiter(void 0, void 0, void 0, function* () {\n    const response = yield FileUtils_1.getFile(auth, uri);\n    return response.text();\n});\nconst getRemoteResourceAsTextStream = (auth, uri) => __awaiter(void 0, void 0, void 0, function* () {\n    const response = yield FileUtils_1.getFile(auth, uri);\n    return response.body;\n});\nconst getRemoteResourceAsRDFStream = (auth, uri) => __awaiter(void 0, void 0, void 0, function* () {\n    const response = yield FileUtils_1.getFile(auth, uri);\n    const textStream = response.body;\n    const content_type = response.headers.get('content-type');\n    if (!content_type)\n        throw new SolidError_1.default('Cannot parse server response. Server response did not contain a content-type header.');\n    return rdf_parse_1.default.parse(textStream, { path: uri, contentType: content_type, baseIRI: uri });\n});\nconst getRemoteResourceAsQuadArray = (auth, uri) => __awaiter(void 0, void 0, void 0, function* () {\n    const rdfStream = yield getRemoteResourceAsRDFStream(auth, uri);\n    return exports.RDFStreamToQuads(rdfStream);\n});\nexports.RDFStreamToQuads = (stream) => {\n    return new Promise((resolve, reject) => {\n        const quads = [];\n        stream\n            .on('data', (quad) => { quads.push(quad); })\n            .on('error', (error) => reject(new SolidError_1.default(`Error parsing notification body.\\n${error.message}`, \"Notification parsing\")))\n            .on('end', () => resolve(quads));\n    });\n};\nexports.getResourceAsDataset = (auth, path, content_type) => __awaiter(void 0, void 0, void 0, function* () {\n    const quadStream = yield getResourceAsRDFStream(auth, path, content_type);\n    return yield exports.getDataset(quadStream);\n});\nexports.getDataset = (quadStream) => __awaiter(void 0, void 0, void 0, function* () {\n    return yield factory.dataset().import(quadStream);\n});\n//# sourceMappingURL=retrieval.js.map","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.validate = void 0;\nconst Logger_1 = require(\"../Utils/Logger\");\nconst factory = require('rdf-ext');\nconst SHACLValidator = require('rdf-validate-shacl');\nfunction validate(notificationDataset, shapesDataset) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const validator = new SHACLValidator(shapesDataset, { factory });\n        const report = yield validator.validate(notificationDataset);\n        Logger_1.log(Logger_1.Level.Log, `Shape conforms: ${report.conforms}, report length: ${report.results.length}`);\n        for (const result of report.results) {\n            // See https://www.w3.org/TR/shacl/#results-validation-result for details\n            // about each property\n            Logger_1.log(Logger_1.Level.Log, result.message);\n            // console.log(result.path)\n            // console.log(result.focusNode)\n            // console.log(result.severity)\n            // console.log(result.sourceConstraintComponent)\n            // console.log(result.sourceShape)\n        }\n        return report.conforms;\n    });\n}\nexports.validate = validate;\n//# sourceMappingURL=Validation.js.map","\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.discoverInbox = exports.fetchInboxNotifications = exports.getInbox = void 0;\nconst FileUtils_1 = require(\"../Utils/FileUtils\");\nconst NameSpaces_1 = __importDefault(require(\"../NameSpaces\"));\nconst SolidError_1 = __importDefault(require(\"../Utils/SolidError\"));\nconst INBOX_LINK_REL = NameSpaces_1.default.ldp('inbox');\nfunction getInbox(auth, webId) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (!webId) {\n            const session = yield auth.currentSession();\n            webId = session === null || session === void 0 ? void 0 : session.webId;\n        }\n        if (!webId)\n            throw new SolidError_1.default(\"No inbox URI. Please maske sure a uri is passed or you are authenticated.\", \"Inbox retrieval\");\n        const inbox = yield discoverInbox(auth, webId);\n        if (!inbox)\n            throw new SolidError_1.default(`Could not find an inbox for resource ${webId}.`, \"Inbox retrieval\");\n        return fetchInboxNotifications(auth, inbox);\n    });\n}\nexports.getInbox = getInbox;\nfunction fetchInboxNotifications(auth, inbox) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const store = yield FileUtils_1.getStoreFromFile(auth, inbox);\n        const notifications = yield getNotificationIdsFromStore(store, inbox);\n        return {\n            id: inbox,\n            notifications\n        };\n    });\n}\nexports.fetchInboxNotifications = fetchInboxNotifications;\n/**\n * Resolves to the LDN Inbox URI for a given resource.\n * @see https://www.w3.org/TR/ldn/#discovery\n * @param uri {string} Resource uri\n * @param webClient {SolidWebClient}\n * @param [resource] {SolidResponse} Optional resource (passed in if you already\n *   have requested the resource and have it handy). Saves making a GET request.\n * @throws {Error} Rejects with an error if the resource has no inbox uri.\n * @return {Promise<string>} Resolves to the inbox uri for the given resource\n */\nfunction discoverInbox(auth, uri) {\n    return __awaiter(this, void 0, void 0, function* () {\n        let response = yield FileUtils_1.getFile(auth, uri, 'Inbox retrieval');\n        if (!response)\n            throw new SolidError_1.default(`Could not retrieve inbox of ${uri}.`, 'Inbox retrieval');\n        // Check response headers for an inbox link\n        const inboxLinkRel = response.headers[INBOX_LINK_REL];\n        if (inboxLinkRel)\n            return inboxLinkRel;\n        const store = yield FileUtils_1.parseResponseToStore(uri, response);\n        // Retrieve inbox match from RDF store\n        const inboxMatches = store.getQuads(uri, NameSpaces_1.default.ldp('inbox'), null, null);\n        for (let match of inboxMatches) {\n            if (match.object.termType === \"NamedNode\")\n                return match.object.id;\n        }\n        // No perfect match was found\n        throw new SolidError_1.default(`Could not retrieve inbox of ${uri}.`, 'Inbox retrieval');\n    });\n}\nexports.discoverInbox = discoverInbox;\nfunction getNotificationIdsFromStore(store, inbox) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const containsQuads = yield store.getQuads(inbox, NameSpaces_1.default.ldp('contains'), null, null);\n        return containsQuads.map((quad) => quad.object.id);\n    });\n}\n//# sourceMappingURL=inbox_retrieval.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar NotificationHandler_1 = require(\"./NotificationHandler\");\nObject.defineProperty(exports, \"NotificationHandler\", { enumerable: true, get: function () { return NotificationHandler_1.NotificationHandler; } });\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NotificationHandler = void 0;\nconst browser_or_node_1 = require(\"browser-or-node\");\nconst SolidError_1 = __importDefault(require(\"./Utils/SolidError\"));\nconst FileUtils_1 = require(\"./Utils/FileUtils\");\nconst NotificationGenerator_1 = __importDefault(require(\"./Notifications/NotificationGenerator\"));\nconst winston = __importStar(require(\"winston\"));\nconst InboxRetrievalAsyncIterator_1 = require(\"./InboxIterators/InboxRetrievalAsyncIterator\");\nconst inbox_retrieval_1 = require(\"./Retrieval/inbox_retrieval\");\nconst InboxRetrievalIterator_1 = __importDefault(require(\"./InboxIterators/InboxRetrievalIterator\"));\nconst streamifyArray = require('streamify-array');\nclass NotificationHandler {\n    constructor(config) {\n        var _a, _b;\n        this.config = config;\n        let level = \"info\";\n        // Set the Logger options based on the passed configuration\n        if ((_a = this.config) === null || _a === void 0 ? void 0 : _a.verbose) {\n            level = \"verbose\";\n        }\n        else if ((_b = this.config) === null || _b === void 0 ? void 0 : _b.cli) {\n            level = \"info\";\n        }\n        else {\n            level = \"warn\";\n        }\n        winston.add(new winston.transports.Console({ level: level }));\n        // Set the auth based on the environment\n        this.auth = this.config.auth || browser_or_node_1.isBrowser\n            ? require('solid-auth-client')\n            : require('solid-auth-cli');\n        // Log the config\n        winston.log('verbose', 'config: ' + JSON.stringify(this.config, null, 2));\n    }\n    /**\n     * Send a notification\n     * @param url\n     * @param notification\n     */\n    sendNotification(notificationData) {\n        return __awaiter(this, void 0, void 0, function* () {\n            this.checkNotificationData(notificationData);\n            // Create the notification from the given notification string / file / template and mappings\n            const notification = yield NotificationGenerator_1.default(this.auth, this.config, notificationData);\n            const results = {};\n            const inboxMapping = [];\n            for (const receiverlist of [notificationData.to, notificationData.cc, notificationData.bcc]) {\n                if (receiverlist) {\n                    for (let receiver of receiverlist) {\n                        try {\n                            let inbox = yield inbox_retrieval_1.discoverInbox(this.auth, receiver);\n                            if (!inbox)\n                                throw new SolidError_1.default(`The inbox of ${receiver} could not be retrieved.\\n`, 'Inbox discovery');\n                            else\n                                inboxMapping.push({ id: receiver, inbox: inbox });\n                        }\n                        catch (e) {\n                            throw new SolidError_1.default(`The inbox of ${receiver} could not be retrieved.\\n${e.message}`, e.name || 'Inbox discovery error');\n                        }\n                    }\n                }\n            }\n            for (let mapping of inboxMapping) {\n                const inbox = mapping.inbox;\n                const receiver = mapping.id;\n                try {\n                    const response = yield FileUtils_1.postFile(this.auth, inbox, notification, notificationData.contentTypeOutput, 'Notification posting');\n                    results[receiver] = response;\n                    winston.log('verbose', 'Notification sent successfully to inbox ' + inbox);\n                }\n                catch (e) {\n                    results[receiver] = new SolidError_1.default(`Error posting notification to inbox of ${receiver}.\\n${e.message}`, e.name || 'Notification posting');\n                }\n            }\n            winston.log('verbose', 'All notifications sent');\n            return results;\n        });\n    }\n    /**\n     * Check if passed parameters allow to create a notification, to catch errors early in the lifecycle\n     * @param notificationData\n     */\n    checkNotificationData(notificationData) {\n        if (notificationData.to.length === 0) {\n            throw new SolidError_1.default('No receiver provided. Provide at least one receiver for the notification');\n        }\n        else if (!(notificationData.notification || notificationData.notification_file || (notificationData.notification_template && notificationData.notification_mapping))) {\n            throw new SolidError_1.default('No notification provided. Provide either a notification object, a notification file, or a notification template file and mapping.');\n        }\n    }\n    clearNotifications(params) {\n        var _a, _b;\n        return __awaiter(this, void 0, void 0, function* () {\n            const webId = yield this.getWebId(params);\n            const notificationIds = ((_a = params.notificationIds) === null || _a === void 0 ? void 0 : _a.length) ? params.notificationIds : (_b = (yield inbox_retrieval_1.getInbox(this.auth, webId))) === null || _b === void 0 ? void 0 : _b.notifications;\n            const failedDeletions = [];\n            for (let notificationId of notificationIds) {\n                try {\n                    yield FileUtils_1.deleteFile(this.auth, notificationId);\n                    winston.log('verbose', 'Deleted notification: ' + notificationId);\n                }\n                catch (e) {\n                    failedDeletions.push({ id: notificationId, error: e });\n                    winston.log('error', 'Failed to delete notification: ' + notificationId);\n                }\n            }\n            winston.log('verbose', 'Finished clearing inbox');\n            if (failedDeletions.length) {\n                throw new SolidError_1.default(`Failed to remove notifications: ${failedDeletions.map(e => e.id).join(', ')}`);\n            }\n        });\n    }\n    fetchNotifications(params) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!params.inbox) {\n                const webId = yield this.getWebId(params);\n                // Setting webId if none present to logged in user webId;\n                params.webId = webId;\n                params.inbox = yield inbox_retrieval_1.discoverInbox(this.auth, webId);\n            }\n            return InboxRetrievalIterator_1.default(this.auth, params); // temp fix, inbox is not optional anymore but type checker does not see inbox is set.\n        });\n    }\n    watchNotifications(params) {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!params.inbox) {\n                const webId = yield this.getWebId(params);\n                // Setting webId if none present to logged in user webId;\n                params.webId = webId;\n                params.inbox = yield inbox_retrieval_1.discoverInbox(this.auth, webId);\n            }\n            return new InboxRetrievalAsyncIterator_1.InboxRetrievalAsyncIterator(this.auth, params); // temp fix, inbox is not optional anymore but type checker does not see inbox is set.\n        });\n    }\n    // Forwarded from login of auth, this concern should maybe be separated to somewhere else, or require an auth to be passed that has been authenticated already?;\n    login(loginOpts) {\n        var _a, _b, _c;\n        return __awaiter(this, void 0, void 0, function* () {\n            const uname = (loginOpts === null || loginOpts === void 0 ? void 0 : loginOpts.username) || this.config.username;\n            const passwd = (loginOpts === null || loginOpts === void 0 ? void 0 : loginOpts.password) || this.config.password;\n            const idp = (loginOpts === null || loginOpts === void 0 ? void 0 : loginOpts.idp) || this.config.idp;\n            // If user is already logged in return\n            if (yield ((_a = this.auth) === null || _a === void 0 ? void 0 : _a.currentSession()))\n                return;\n            // Try to set a new authentication agent if none has been set\n            if (browser_or_node_1.isBrowser) {\n                // TODO:: This is probably inadequate?\n                const idp = this.config.idp || this.config.idp;\n                if (!idp)\n                    throw new SolidError_1.default('No identity provider passed to login via browser. \\nPlease pass an identity provider in the config file or or in the parameter of the login function.', 'LoginError');\n                try {\n                    yield ((_b = this.auth) === null || _b === void 0 ? void 0 : _b.login(idp));\n                }\n                catch (e) {\n                    throw new SolidError_1.default(`Could not login to solid. \\n${e.message}`);\n                }\n            }\n            else if (browser_or_node_1.isNode) {\n                const credentials = {\n                    idp: idp,\n                    username: uname,\n                    password: passwd\n                };\n                if (!credentials.idp || !credentials.username || !credentials.password) {\n                    throw new SolidError_1.default('Identity provider, username and password are required to login to Solid if no session is found. \\n\\\n           Please pass these parameters via the config file, or in the parameter of the login function.', 'LoginError');\n                }\n                try {\n                    yield ((_c = this.auth) === null || _c === void 0 ? void 0 : _c.login(credentials));\n                }\n                catch (e) {\n                    throw new SolidError_1.default(`Could not login to solid. \\n${e.message}`);\n                }\n            }\n            else {\n                throw new SolidError_1.default('This application is only designed to work in Node or in the Browser.');\n            }\n        });\n    }\n    // Forwarded from login of auth, this concern should maybe be separated to somewhere else, or require an auth to be passed that has been authenticated already?;\n    loginPopup(popupURI) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            if (!browser_or_node_1.isBrowser) {\n                throw new SolidError_1.default('Login via popup can only be used in browser environments', 'LoginError');\n            }\n            // If user is already logged in return\n            if (yield ((_a = this.auth) === null || _a === void 0 ? void 0 : _a.currentSession()))\n                return;\n            // Try to show popup\n            const popupLocation = popupURI || this.config.popup;\n            if (popupLocation) {\n                try {\n                    this.auth.popupLogin(popupLocation);\n                }\n                catch (e) {\n                    throw new SolidError_1.default(`Could not login with popup. \\n${e.message}`);\n                }\n            }\n            else {\n                throw new SolidError_1.default('No login popup uri. Please pass a popup uri via the config file or or in the parameter of the loginPopup function.', 'LoginError');\n            }\n        });\n    }\n    getWebId(params) {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            let webId = params.webId;\n            if (!webId) {\n                const session = yield ((_a = this.auth) === null || _a === void 0 ? void 0 : _a.currentSession());\n                webId = session === null || session === void 0 ? void 0 : session.webId;\n            }\n            if (!webId) {\n                throw new SolidError_1.default('Please authenticate yourself.');\n            }\n            return webId;\n        });\n    }\n    logout() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            (_a = this.auth) === null || _a === void 0 ? void 0 : _a.logout();\n        });\n    }\n}\nexports.NotificationHandler = NotificationHandler;\n//# sourceMappingURL=NotificationHandler.js.map"],"sourceRoot":""}